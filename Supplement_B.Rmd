---
title: 'Supplement B'
subtitle: 'Reward sensitivity and internalizing symptoms during the transition to puberty: An examination of 9- and 10-year-olds in the ABCD Study.'
output:
  pdf_document:
    toc: yes
    toc_depth: '3'
    df_print: paged
  html_document:
    toc: yes
    toc_depth: '3'
    toc_float:
      collapsed: true
    df_print: paged
---
# Results for Sample 2


```{r loadPackages, echo = FALSE, message=FALSE, warning=FALSE, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(ggplot2)
library(gamm4)
library(dplyr)
library(insight)
library(here)
library(lmerTest)
library(gamm4.test)
library(mgcv)
library(jtools)
library(interactions)
library(naniar) # For replacing certain values with "NA" instead.
library(Hmisc) # for correlation matrix.
#library(ggstatsplot)

data_dir = ((dirname(here()))) 

#phase_folder = "exploratory"  # select the appropriate folder.
phase_folder = "confirmatory"  # select the appropriate folder.

data_folder <- file.path(data_dir,"ABCD","derivatives",phase_folder)

file_name <- "nda30_confirmatory.csv" # specify file name here. 

fulldata <- read.csv(file.path(data_folder,file_name))
nrow(fulldata) # 27321 (exploratory). When call the define_dataframes script, will keep only the baseline data.

# Call function to define all of the dataframes.
script_path <- file.path(data_dir,"rewardprocesses_internalizing_puberty_exploratory","code","define_dataframes.R")
source(script_path)
```

# 1---Internalizing~Puberty---

## 1.1 Model: CBCL internalizing factor ~ PDS
### Females
```{r, echo=FALSE}
dataformodel <- PDS_correct_females

confirmatory2_females <- gamm4(cbcl_scr_syn_internal_r ~ PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))

summary(confirmatory2_females$gam)
```
### Males
```{r, echo=FALSE}
dataformodel <- PDS_correct_males

confirmatory2_males <- gamm4(cbcl_scr_syn_internal_r ~ PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
          
summary(confirmatory2_males$gam)

```

## 1.2 Model: CBCL Anxious-Depressed ~ PDS
### Females
```{r, echo=FALSE}
dataformodel <- PDS_correct_females

confirmatory2_females <- gamm4(cbcl_scr_syn_anxdep_r ~ PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))

summary(confirmatory2_females$gam)

```
### Males
```{r, echo=FALSE}
dataformodel <- PDS_correct_males

confirmatory2_males <- gamm4(cbcl_scr_syn_anxdep_r ~ PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
          
summary(confirmatory2_males$gam)

```
## 1.3 Model: CBCL Withdrawn-Depressed ~ PDS
### Females
```{r, echo=FALSE}
dataformodel <- PDS_correct_females

confirmatory2_females <- gamm4(cbcl_scr_syn_withdep_r ~ PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))

summary(confirmatory2_females$gam)

```
### Males
```{r, echo=FALSE}
dataformodel <- PDS_correct_males

confirmatory2_males <- gamm4(cbcl_scr_syn_withdep_r ~ PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
          
summary(confirmatory2_males$gam)

```
## 1.4 Model: CBCL Depressed DSM-5 ~ PDS
### Females
```{r, echo=FALSE}
dataformodel <- PDS_correct_females

confirmatory2_females <- gamm4(cbcl_scr_dsm5_depress_r ~ PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))

summary(confirmatory2_females$gam)
```
### Males
```{r, echo=FALSE}
dataformodel <- PDS_correct_males

confirmatory2_males <- gamm4(cbcl_scr_dsm5_depress_r ~ PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
          
summary(confirmatory2_males$gam)

```



## 1.5 Model: CBCL internalizing factor ~ Pubertal category
### Females
```{r, echo=FALSE}
dataformodel <- PDS_correct_females
confirmatory2_category_females <- gamm4(cbcl_scr_syn_internal_r ~ pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
summary(confirmatory2_category_females$gam) 
```
### Males
```{r, echo=FALSE}
dataformodel <- PDS_correct_males
confirmatory2_category_males <- gamm4(cbcl_scr_syn_internal_r ~ pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
summary(confirmatory2_category_males$gam)
```

## 1.6 Model: CBCL Anxious-Depressed ~ Pubertal category
### Females 
```{r, echo=FALSE}
dataformodel <- PDS_correct_females
confirmatory2_category_females <- gamm4(cbcl_scr_syn_anxdep_r ~ pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
summary(confirmatory2_category_females$gam) 
```
### Males
```{r, echo=FALSE}
dataformodel <- PDS_correct_males
confirmatory2_category_males <- gamm4(cbcl_scr_syn_anxdep_r ~ pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
summary(confirmatory2_category_males$gam)
```

## 1.7 Model: CBCL Withdrawn-Depressed ~ Pubertal category
### Females
```{r, echo=FALSE}
dataformodel <- PDS_correct_females
confirmatory2_category_females <- gamm4(cbcl_scr_syn_withdep_r ~ pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
summary(confirmatory2_category_females$gam) 
```
### Males
```{r, echo=FALSE}
dataformodel <- PDS_correct_males
confirmatory2_category_males <- gamm4(cbcl_scr_syn_withdep_r ~ pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
summary(confirmatory2_category_males$gam)
```

## 1.8 Model: CBCL Depressed DSM-5 ~ Pubertal category
### Females
```{r, echo=FALSE}
dataformodel <- PDS_correct_females
confirmatory2_category_females <- gamm4(cbcl_scr_dsm5_depress_r ~ pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
summary(confirmatory2_category_females$gam) 
```
### Males
```{r, echo=FALSE}
dataformodel <- PDS_correct_males
confirmatory2_category_males <- gamm4(cbcl_scr_dsm5_depress_r ~ pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
summary(confirmatory2_category_males$gam)
```



## 1.9 Model: CBCL internalizing factor ~ Testosterone
### Females
```{r, echo=FALSE}
dataformodel <- data_no_test_outliers_females

confirmatory2_testosterone_CBCL_female <- gamm4(cbcl_scr_syn_internal_r ~ hormone_scr_ert_mean +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2_testosterone_CBCL_female$gam)
```
### Males
```{r, echo=FALSE}
dataformodel <- data_no_test_outliers_males

confirmatory2_testosterone_CBCL_male <- gamm4(cbcl_scr_syn_internal_r ~ hormone_scr_ert_mean +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2_testosterone_CBCL_male$gam)
```
## 1.10 Model: CBCL Anxious-Depressed ~ Testosterone
### Females
```{r, echo=FALSE}
dataformodel <- data_no_test_outliers_females

confirmatory2_testosterone_CBCL_female <- gamm4(cbcl_scr_syn_anxdep_r ~ hormone_scr_ert_mean +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2_testosterone_CBCL_female$gam)
```
### Males
```{r, echo=FALSE}
dataformodel <- data_no_test_outliers_males

confirmatory2_testosterone_CBCL_male <- gamm4(cbcl_scr_syn_anxdep_r ~ hormone_scr_ert_mean +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2_testosterone_CBCL_male$gam)
```

## 1.11 Model: CBCL Withdrawn-Depressed ~ Testosterone
### Females
```{r, echo=FALSE}
dataformodel <- data_no_test_outliers_females

confirmatory2_testosterone_CBCL_female <- gamm4(cbcl_scr_syn_withdep_r ~ hormone_scr_ert_mean +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2_testosterone_CBCL_female$gam)
```

### Males
```{r, echo=FALSE}
dataformodel <- data_no_test_outliers_males

confirmatory2_testosterone_CBCL_male <- gamm4(cbcl_scr_syn_withdep_r ~ hormone_scr_ert_mean +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2_testosterone_CBCL_male$gam)
```
## 1.12 Model: CBCL Depressed DSM-5 ~ Testosterone
### Females
```{r, echo=FALSE}
dataformodel <- data_no_test_outliers_females

confirmatory2_testosterone_CBCL_female <- gamm4(cbcl_scr_dsm5_depress_r ~ hormone_scr_ert_mean +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2_testosterone_CBCL_female$gam)
```
### Males
```{r, echo=FALSE}
dataformodel <- data_no_test_outliers_males

confirmatory2_testosterone_CBCL_male <- gamm4(cbcl_scr_dsm5_depress_r ~ hormone_scr_ert_mean +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2_testosterone_CBCL_male$gam)
```


## 1.13 Model: CBCL internalizing factor ~ Testosterone + PDS 
### Females
```{r, echo=FALSE}

dataformodel <- data_no_test_outliers_females

confirmatory2B_testosterone_CBCL_female <- gamm4(cbcl_scr_syn_internal_r ~ hormone_scr_ert_mean + PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,  
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_female$gam)
```
### Males
```{r, echo=FALSE}
dataformodel <- data_no_test_outliers_males 
  

confirmatory2B_testosterone_CBCL_male <- gamm4(cbcl_scr_syn_internal_r ~ hormone_scr_ert_mean + PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_male$gam)
```

## 1.14 Model: CBCL internalizing factor ~ Testosterone + Pubertal category 
### Females
```{r, echo=FALSE}
# PDS category.

dataformodel <- subset(PDS_correct_females, hormone_scr_ert_mean_z > -3 & hormone_scr_ert_mean_z < 3 & pds_p_ss_category !="5")

confirmatory2B_testosterone_CBCL_female_category <- gamm4(cbcl_scr_syn_internal_r ~ hormone_scr_ert_mean + pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,  
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_female_category$gam)
```
### Males
```{r, echo=FALSE}
# PDS category.

dataformodel <- subset(PDS_correct_males, hormone_scr_ert_mean_z > -3 & hormone_scr_ert_mean_z < 3 & pds_p_ss_category !="5")

confirmatory2B_testosterone_CBCL_male_category <- gamm4(cbcl_scr_syn_internal_r ~ hormone_scr_ert_mean + pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_male_category$gam)
```
## 1.15 Model: CBCL Anxious-Depressed ~ Testosterone + PDS 
### Females
```{r, echo=FALSE}

dataformodel <- data_no_test_outliers_females

confirmatory2B_testosterone_CBCL_female <- gamm4(cbcl_scr_syn_anxdep_r ~ hormone_scr_ert_mean + PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,  
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_female$gam)
```
### Males
```{r, echo=FALSE}

dataformodel <- data_no_test_outliers_males 
  
confirmatory2B_testosterone_CBCL_male <- gamm4(cbcl_scr_syn_anxdep_r ~ hormone_scr_ert_mean + PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_male$gam)
```

## 1.16 Model: CBCL Anxious-Depressed ~ Testosterone + Pubertal category
### Females
```{r, echo=FALSE}
# PDS category.

dataformodel <- subset(PDS_correct_females, hormone_scr_ert_mean_z > -3 & hormone_scr_ert_mean_z < 3 & pds_p_ss_category !="5")

confirmatory2B_testosterone_CBCL_female_category <- gamm4(cbcl_scr_syn_anxdep_r ~ hormone_scr_ert_mean + pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,  
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_female_category$gam)
```
### Males
```{r, echo=FALSE}
# PDS category.

dataformodel <- subset(PDS_correct_males, hormone_scr_ert_mean_z > -3 & hormone_scr_ert_mean_z < 3 & pds_p_ss_category !="5")

confirmatory2B_testosterone_CBCL_male_category <- gamm4(cbcl_scr_syn_anxdep_r ~ hormone_scr_ert_mean + pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_male_category$gam)
```
## 1.17 Model: CBCL Withdrawn-Depressed ~ Testosterone + PDS
### Females
```{r, echo=FALSE}

dataformodel <- data_no_test_outliers_females

confirmatory2B_testosterone_CBCL_female <- gamm4(cbcl_scr_syn_withdep_r ~ hormone_scr_ert_mean + PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,  
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_female$gam)
```
### Males
```{r, echo=FALSE}

dataformodel <- data_no_test_outliers_males 
  
confirmatory2B_testosterone_CBCL_male <- gamm4(cbcl_scr_syn_withdep_r ~ hormone_scr_ert_mean + PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_male$gam)
```
## 1.18 Model: CBCL Withdrawn-Depressed ~ Testosterone + Pubertal category
### Females
```{r, echo=FALSE}
# PDS category.

dataformodel <- subset(PDS_correct_females, hormone_scr_ert_mean_z > -3 & hormone_scr_ert_mean_z < 3 & pds_p_ss_category !="5")

confirmatory2B_testosterone_CBCL_female_category <- gamm4(cbcl_scr_syn_withdep_r ~ hormone_scr_ert_mean + pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,  
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_female_category$gam)
```
### Males
```{r, echo=FALSE}
# PDS category.

dataformodel <- subset(PDS_correct_males, hormone_scr_ert_mean_z > -3 & hormone_scr_ert_mean_z < 3 & pds_p_ss_category !="5")

confirmatory2B_testosterone_CBCL_male_category <- gamm4(cbcl_scr_syn_withdep_r ~ hormone_scr_ert_mean + pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_male_category$gam)
```
## 1.19 Model: CBCL Depressed DSM-5 ~ Testosterone + PDS 
### Females
```{r, echo=FALSE}

dataformodel <- data_no_test_outliers_females

confirmatory2B_testosterone_CBCL_female <- gamm4(cbcl_scr_dsm5_depress_r ~ hormone_scr_ert_mean + PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,  
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_female$gam)
```
### Males
```{r, echo=FALSE}

dataformodel <- data_no_test_outliers_males 
  

confirmatory2B_testosterone_CBCL_male <- gamm4(cbcl_scr_dsm5_depress_r ~ hormone_scr_ert_mean + PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_male$gam)
```

## 1.20 Model: CBCL Depressed DSM-5 ~ Testosterone + Pubertal category 
### Females
```{r, echo=FALSE}
# PDS category.

dataformodel <- subset(PDS_correct_females, hormone_scr_ert_mean_z > -3 & hormone_scr_ert_mean_z < 3 & pds_p_ss_category !="5")

confirmatory2B_testosterone_CBCL_female_category <- gamm4(cbcl_scr_dsm5_depress_r ~ hormone_scr_ert_mean + pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,  
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_female_category$gam)
```
### Males
```{r, echo=FALSE}
# PDS category.

dataformodel <- subset(PDS_correct_males, hormone_scr_ert_mean_z > -3 & hormone_scr_ert_mean_z < 3 & pds_p_ss_category !="5")

confirmatory2B_testosterone_CBCL_male_category <- gamm4(cbcl_scr_dsm5_depress_r ~ hormone_scr_ert_mean + pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_male_category$gam)
```







# 2---Reward~Puberty---

## 2.1 Model: BIS-BAS-RR ~ PDS
### Females
```{r, echo = FALSE}
dataformodel <- data_no_bisbas_outliers_females

exploratory1B_females <- gamm4(bisbas_ss_basm_rr_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1B_females$gam)

```
### Males
```{r, echo = FALSE}
dataformodel <- data_no_bisbas_outliers_males

exploratory1B_males <- gamm4(bisbas_ss_basm_rr_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1B_males$gam)

```


## 2.2 Model : Reaction Time ~ PDS

### Females
```{r, echo = FALSE}
dataformodel <- data_no_RT_MID_outliers_females

# Large reward vs. neutral positive.
exploratory1C_lg_neutral_RT_females <- gamm4(rt_diff_large_neutral_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1C_lg_neutral_RT_females$gam)


# Large reward vs. small positive.
exploratory1C_lg_small_RT_females <- gamm4(rt_diff_large_small_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1C_lg_small_RT_females$gam)
```

### Males
```{r, echo = FALSE}
dataformodel <- data_no_RT_MID_outliers_males

# Large reward vs. neutral positive.
exploratory1C_lg_neutral_RT_males <- gamm4(rt_diff_large_neutral_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1C_lg_neutral_RT_males$gam)


# Large reward vs. small positive.
exploratory1C_lg_small_RT_males <- gamm4(rt_diff_large_small_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1C_lg_small_RT_males$gam)
```



## 2.3 Model: Caudate Anticipation ~ PDS
### Females
```{r, echo = FALSE}
dataformodel <- data_no_caudate_ant_outliers_females 

confirmatory1_caudate_females <- gamm4(caudate_rvsn_ant_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(confirmatory1_caudate_females$gam)

```

### Males
```{r, echo = FALSE}
dataformodel <- data_no_striatal_ant_outliers_males

confirmatory1_caudate_males<- gamm4(caudate_rvsn_ant_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(confirmatory1_caudate_males$gam)

```

## 2.4 Model B: Putamen Anticipation ~ PDS
### Females
```{r, echo = FALSE}
dataformodel <- data_no_putamen_ant_outliers_females 

confirmatory1_putamen_females <- gamm4(putamen_rvsn_ant_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(confirmatory1_putamen_females$gam)

```

### Males
```{r, echo = FALSE}
dataformodel <- data_no_putamen_ant_outliers_males 

confirmatory1_putamen_males <- gamm4(putamen_rvsn_ant_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(confirmatory1_putamen_males$gam)
```

## 2.5 Model: Accumbens Anticipation ~ PDS
### Females
```{r, echo = FALSE}
dataformodel <- data_no_accumbens_ant_outliers_females 

confirmatory1_accumbens_females <- gamm4(accumbens_rvsn_ant_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(confirmatory1_accumbens_females$gam)

```

### Males
```{r, echo = FALSE}
dataformodel <- data_no_accumbens_ant_outliers_males 

confirmatory1_accumbens_males <- gamm4(accumbens_rvsn_ant_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(confirmatory1_accumbens_males$gam)

```


## 2.6 Model: Caudate Feedback  ~ PDS
### Females
```{r, echo = FALSE}
dataformodel <- data_no_caudate_feed_outliers_females

exploratory1A_caudate_females <- gamm4(caudate_posvsneg_feedback_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1A_caudate_females$gam)

```

### Males
```{r, echo = FALSE}
dataformodel <- data_no_caudate_feed_outliers_males

exploratory1A_caudate_males <- gamm4(caudate_posvsneg_feedback_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1A_caudate_males$gam)

```
## 2.7 Model: Putamen Feedback ~ PDS
### Females
```{r, echo = FALSE}
dataformodel <- data_no_putamen_feed_outliers_females

exploratory1A_putamen_females <- gamm4(putamen_posvsneg_feedback_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1A_putamen_females$gam)

```

### Males
```{r, echo = FALSE}
dataformodel <- data_no_putamen_feed_outliers_males

exploratory1A_putamen_males <- gamm4(putamen_posvsneg_feedback_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1A_putamen_males$gam)

```
## 2.8 Model: Accumbens Feedback ~ PDS
### Females
```{r, echo = FALSE}
dataformodel <- data_no_accumbens_feed_outliers_females

exploratory1A_accumbens_females <- gamm4(accumbens_posvsneg_feedback_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1A_accumbens_females$gam)

```

### Males
```{r, echo = FALSE}
dataformodel <- data_no_accumbens_feed_outliers_males

exploratory1A_accumbens_males <- gamm4(accumbens_posvsneg_feedback_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1A_accumbens_males$gam)

```
## 2.9 Model: OFC Anticipation ~ PDS
### Females
```{r, echo = FALSE}

# Females (lateral OFC; lOFC).
dataformodel <- data_no_lOFC_ant_outliers_females
modelC_females_lOFC <- gamm4(lOFC_rvsn_ant_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelC_females_lOFC$gam)


# Females (medial OFC; mOFC).
dataformodel <- data_no_mOFC_ant_outliers_females
modelC_females_mOFC <- gamm4(mOFC_rvsn_ant_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelC_females_mOFC$gam)
```
### Males
```{r, echo=FALSE}
# Males (lateral OFC; lOFC).
dataformodel <- data_no_lOFC_ant_outliers_males
modelC_males_lOFC <- gamm4(lOFC_rvsn_ant_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelC_males_lOFC$gam)


# Males (medial OFC; mOFC).
dataformodel <- data_no_mOFC_ant_outliers_males
modelC_males_mOFC <- gamm4(mOFC_rvsn_ant_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelC_males_mOFC$gam)
```

## 2.10 Model: OFC Feedback ~ PDS
### Females
```{r, echo = FALSE}
# Females (lateral OFC; lOFC).
dataformodel <- data_no_lOFC_feed_outliers_females
modelD_females_lOFC <- gamm4(lOFC_posvsneg_feedback_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelD_females_lOFC$gam)


# Females (medial OFC; mOFC).
dataformodel <- data_no_mOFC_feed_outliers_females
modelD_females_mOFC <- gamm4(mOFC_posvsneg_feedback_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelD_females_mOFC$gam)
```

### Males
```{r, echo=FALSE}
# Males (lateral OFC; lOFC).
dataformodel <- data_no_lOFC_feed_outliers_males
modelD_males_lOFC <- gamm4(lOFC_posvsneg_feedback_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelD_males_lOFC$gam)


# Males (medial OFC; mOFC).
dataformodel <- data_no_mOFC_feed_outliers_males
modelD_males_mOFC <- gamm4(mOFC_posvsneg_feedback_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelD_males_mOFC$gam)
```





## 2.11 Model: Caudate Anticipation ~ Testosterone
### Females
```{r, echo = FALSE}
dataformodel <- data_no_caudate_ant_no_test_outliers_females 

confirmatory1_caudate_females <- gamm4(caudate_rvsn_ant_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(confirmatory1_caudate_females$gam)

```
### Males
```{r, echo = FALSE}
dataformodel <- data_no_caudate_ant_no_test_outliers_males

confirmatory1_caudate_males<- gamm4(caudate_rvsn_ant_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(confirmatory1_caudate_males$gam)

```

## 2.12 Model B: Putamen Anticipation ~ Testosterone
### Females
```{r, echo = FALSE}
dataformodel <- data_no_putamen_ant_no_test_outliers_females 

confirmatory1_putamen_females <- gamm4(putamen_rvsn_ant_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(confirmatory1_putamen_females$gam)

```
### Males
```{r, echo = FALSE}
dataformodel <- data_no_putamen_ant_no_test_outliers_males 

confirmatory1_putamen_males <- gamm4(putamen_rvsn_ant_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(confirmatory1_putamen_males$gam)
```

## 2.13 Model: Accumbens Anticipation ~ Testosterone
### Females
```{r, echo = FALSE}
dataformodel <- data_no_accumbens_ant_no_test_outliers_females 

confirmatory1_accumbens_females <- gamm4(accumbens_rvsn_ant_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(confirmatory1_accumbens_females$gam)
```
### Males
```{r, echo = FALSE}
dataformodel <- data_no_accumbens_ant_no_test_outliers_males 

confirmatory1_accumbens_males <- gamm4(accumbens_rvsn_ant_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(confirmatory1_accumbens_males$gam)
```


## 2.14 Model: Caudate Feedback  ~ Testosterone
### Females
```{r, echo = FALSE}
dataformodel <- data_no_caudate_feed_no_test_outliers_females

exploratory1A_caudate_females <- gamm4(caudate_posvsneg_feedback_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1A_caudate_females$gam)
```
### Males
```{r, echo = FALSE}
dataformodel <- data_no_caudate_feed_no_test_outliers_males

exploratory1A_caudate_males <- gamm4(caudate_posvsneg_feedback_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1A_caudate_males$gam)

```
## 2.15 Model: Putamen Feedback ~ Testosterone
### Females
```{r, echo = FALSE}
dataformodel <- data_no_putamen_feed_no_test_outliers_females

exploratory1A_putamen_females <- gamm4(putamen_posvsneg_feedback_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1A_putamen_females$gam)
```
### Males
```{r, echo = FALSE}
dataformodel <- data_no_putamen_feed_outliers_no_test_males

exploratory1A_putamen_males <- gamm4(putamen_posvsneg_feedback_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1A_putamen_males$gam)
```
## 2.16 Model: Accumbens Feedback ~ Testosterone
### Females
```{r, echo = FALSE}
dataformodel <- data_no_accumbens_feed_no_test_outliers_females

exploratory1A_accumbens_females <- gamm4(accumbens_posvsneg_feedback_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1A_accumbens_females$gam)
```
### Males
```{r, echo = FALSE}
dataformodel <- data_no_accumbens_feed_no_test_outliers_males

exploratory1A_accumbens_males <- gamm4(accumbens_posvsneg_feedback_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1A_accumbens_males$gam)

```



## 2.17 Model: OFC Anticipation ~ Testosterone
### Females
```{r, echo = FALSE}

# Females (lateral OFC; lOFC).
dataformodel <- data_no_lOFC_ant_test_outliers_females
modelC_females_lOFC <- gamm4(lOFC_rvsn_ant_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelC_females_lOFC$gam)


# Females (medial OFC; mOFC).
dataformodel <- data_no_mOFC_ant_test_outliers_females
modelC_females_mOFC <- gamm4(mOFC_rvsn_ant_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelC_females_mOFC$gam)

```

### Males
```{r, echo=FALSE}
# Males (lateral OFC; lOFC).
dataformodel <- data_no_lOFC_ant_test_outliers_males
modelC_males_lOFC <- gamm4(lOFC_rvsn_ant_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelC_males_lOFC$gam)


# Males (medial OFC; mOFC).
dataformodel <- data_no_mOFC_ant_test_outliers_males
modelC_males_mOFC <- gamm4(mOFC_rvsn_ant_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelC_males_mOFC$gam)
```

## 2.18 Model: OFC Feedback ~ Testosterone
### Females
```{r, echo = FALSE}

# Females (lateral OFC; lOFC).
dataformodel <- data_no_lOFC_feed_test_outliers_females
modelD_females_lOFC <- gamm4(lOFC_posvsneg_feedback_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelD_females_lOFC$gam)


# Females (medial OFC; mOFC).
dataformodel <- data_no_mOFC_feed_test_outliers_females
modelD_females_mOFC <- gamm4(mOFC_posvsneg_feedback_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelD_females_mOFC$gam)
```

### Males
```{r, echo=FALSE}

# Males (lateral OFC; lOFC).
dataformodel <- data_no_lOFC_feed_test_outliers_males
modelD_males_lOFC <- gamm4(lOFC_posvsneg_feedback_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelD_males_lOFC$gam)


# Males (medial OFC; mOFC).
dataformodel <- data_no_mOFC_feed_test_outliers_males
modelD_males_mOFC <- gamm4(mOFC_posvsneg_feedback_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelD_males_mOFC$gam)
```

## 2.19 Model: MID Reaction Time ~ Testosterone
### Females
```{r, echo = FALSE}

# Females: large reward vs. neutral.
dataformodel <- data_no_RT_test_outliers_females # No MID RT difference score or testosterone outliers.
modelE_lg_neutral_RT_females <- gamm4(rt_diff_large_neutral_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelE_lg_neutral_RT_females$gam)

# Females: large reward vs. small reward.
dataformodel <- data_no_RT_test_outliers_females # No MID RT difference score or testosterone outliers.
modelE_lg_small_RT_females <- gamm4(rt_diff_large_small_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelE_lg_small_RT_females$gam)
```

### Males
```{r, echo=FALSE}
# Males: large reward vs. neutral.
dataformodel <- data_no_RT_test_outliers_males # No MID RT difference score or testosterone outliers.

modelE_lg_neutral_RT_males <- gamm4(rt_diff_large_neutral_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelE_lg_neutral_RT_males$gam)

# Males: large reward vs. small reward.
modelE_lg_small_RT_males <- gamm4(rt_diff_large_small_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelE_lg_small_RT_males$gam)
```

## 2.20 Model: BIS-BAS-RR ~ Testosterone
### Females
```{r, echo = FALSE}

dataformodel <- data_no_bisbas_test_outliers_females
modelF_females <- gamm4(bisbas_ss_basm_rr_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelF_females$gam)
```
### Males
```{r, echo=FALSE}
dataformodel <- data_no_bisbas_test_outliers_males
modelF_males <- gamm4(bisbas_ss_basm_rr_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelF_males$gam)
```









# 3---Internalizing~Reward---

## 3.1 Model: CBCL internalizing factor ~ Nucleus Accumbens activity (anticipation stage)
### Females
```{r, echo = FALSE}

dataformodel <- data_no_accumbens_ant_outliers_females

confirmatory3A_nacc_females <- gamm4(cbcl_scr_syn_internal_r ~ accumbens_rvsn_ant_z +
                              interview_age
                              , 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(confirmatory3A_nacc_females$gam)


```
### Males
```{r, echo = FALSE}
dataformodel <- data_no_accumbens_ant_outliers_males

confirmatory3A_nacc_males <- gamm4(cbcl_scr_syn_internal_r ~ accumbens_rvsn_ant_z +
                              interview_age
                              , 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(confirmatory3A_nacc_males$gam)

```

## 3.2 Model: CBCL internalizing factor ~ Caudate activity (anticipation stage)
### Females
```{r, echo = FALSE}
dataformodel <- data_no_caudate_ant_outliers_females

confirmatory3A_caud_females <- gamm4(cbcl_scr_syn_internal_r ~ caudate_rvsn_ant_z +
                              interview_age
                              , 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(confirmatory3A_caud_females$gam)


```
### Males
```{r, echo = FALSE}
dataformodel <- data_no_caudate_ant_outliers_males

confirmatory3A_caud_males <- gamm4(cbcl_scr_syn_internal_r ~ caudate_rvsn_ant_z +
                               interview_age
                              , 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(confirmatory3A_caud_males$gam)


```

## 3.3 Model: CBCL internalizing factor ~ Putamen activity (anticipation stage)
### Females
```{r, echo = FALSE}
dataformodel <- data_no_putamen_ant_outliers_females

confirmatory3A_putamen_females <- gamm4(cbcl_scr_syn_internal_r ~ putamen_rvsn_ant_z +
                               interview_age
                              , 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(confirmatory3A_putamen_females$gam)


```
### Males
```{r, echo = FALSE}
dataformodel <- data_no_putamen_ant_outliers_males

confirmatory3A_putamen_males <- gamm4(cbcl_scr_syn_internal_r ~ putamen_rvsn_ant_z +
                              interview_age
                              , 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(confirmatory3A_putamen_males$gam)

```


## 3.4 Model: CBCL internalizing factor ~ Accumbens activity (feedback stage)
### Females
```{r, echo = FALSE}
dataformodel <- data_no_accumbens_feed_outliers_females

confirmatory3B_accumbens_females <- gamm4(cbcl_scr_syn_internal_r ~ accumbens_posvsneg_feedback_z +
                              interview_age
                              , 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(confirmatory3B_accumbens_females$gam)

```
### Males
```{r, echo = FALSE}
dataformodel <- data_no_accumbens_feed_outliers_males

confirmatory3B_accumbens_males <- gamm4(cbcl_scr_syn_internal_r ~ accumbens_posvsneg_feedback_z +
                              interview_age
                              , 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(confirmatory3B_accumbens_males$gam)
```

## 3.5 Model: CBCL internalizing factor ~ Caudate activity (feedback stage)
### Females
```{r, echo = FALSE}
dataformodel <- data_no_caudate_feed_outliers_females

confirmatory3B_caudate_females <- gamm4(cbcl_scr_syn_internal_r ~ caudate_posvsneg_feedback_z +
                              interview_age
                              , 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(confirmatory3B_caudate_females$gam)

```
### Males
```{r, echo = FALSE}
dataformodel <- data_no_caudate_feed_outliers_males

confirmatory3B_caudate_males <- gamm4(cbcl_scr_syn_internal_r ~ caudate_posvsneg_feedback_z +
                              interview_age
                              , 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(confirmatory3B_caudate_males$gam)
```

## 3.6 Model: CBCL internalizing factor ~ Putamen activity (feedback stage)
### Females
```{r, echo = FALSE}
dataformodel <- data_no_putamen_feed_outliers_females

confirmatory3B_putamen_females <- gamm4(cbcl_scr_syn_internal_r ~ putamen_posvsneg_feedback_z +
                              interview_age
                              , 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(confirmatory3B_putamen_females$gam)

```
### Males
```{r, echo = FALSE}
dataformodel <- data_no_putamen_feed_outliers_males

confirmatory3B_putamen_males <- gamm4(cbcl_scr_syn_internal_r ~ putamen_posvsneg_feedback_z +
                              interview_age
                              , 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(confirmatory3B_putamen_males$gam)
```

## 3.7 Model: CBCL internalizing factor ~ OFC activity (anticipation stage)
### Females
```{r, echo = FALSE}
# Lateral OFC.
dataformodel <- data_no_lOFC_ant_outliers_females
confirmatory3C_lOFC_females <- gamm4(cbcl_scr_syn_internal_r ~ lOFC_rvsn_ant_z +
                              interview_age
                              , 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(confirmatory3C_lOFC_females$gam)

# Medial OFC.
dataformodel <- data_no_mOFC_ant_outliers_females
confirmatory3C_mOFC_females <- gamm4(cbcl_scr_syn_internal_r ~ mOFC_rvsn_ant_z +
                              interview_age
                              , 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(confirmatory3C_mOFC_females$gam)
```
### Males
```{r, echo = FALSE}
# Lateral OFC.
dataformodel <- data_no_lOFC_ant_outliers_males
confirmatory3C_lOFC_males <- gamm4(cbcl_scr_syn_internal_r ~ lOFC_rvsn_ant_z +
                              interview_age
                              , 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(confirmatory3C_lOFC_males$gam)

# Medial OFC.
dataformodel <- data_no_mOFC_ant_outliers_males
confirmatory3C_mOFC_males <- gamm4(cbcl_scr_syn_internal_r ~ mOFC_rvsn_ant_z +
                              interview_age
                              , 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(confirmatory3C_mOFC_males$gam)
```

## 3.8 Model: CBCL internalizing factor ~ OFC activity (feedback stage)
### Females
```{r, echo = FALSE}
# Lateral OFC.
dataformodel <- data_no_lOFC_feed_outliers_females

confirmatory3D_lOFC_females <- gamm4(cbcl_scr_syn_internal_r ~ lOFC_posvsneg_feedback_z +
                              interview_age
                              , 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(confirmatory3D_lOFC_females$gam)

# Medial OFC.
dataformodel <- data_no_mOFC_feed_outliers_females
confirmatory3D_mOFC_females <- gamm4(cbcl_scr_syn_internal_r ~ mOFC_posvsneg_feedback_z +
                              interview_age
                              , 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(confirmatory3D_mOFC_females$gam)

```
### Males
```{r, echo = FALSE}
# Lateral OFC.
dataformodel <- data_no_lOFC_feed_outliers_males

confirmatory3D_lOFC_males <- gamm4(cbcl_scr_syn_internal_r ~ lOFC_posvsneg_feedback_z +
                              interview_age
                              , 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(confirmatory3D_lOFC_males$gam)


# Medial OFC.
dataformodel <- data_no_mOFC_feed_outliers_males
confirmatory3D_mOFC_males <- gamm4(cbcl_scr_syn_internal_r ~ mOFC_posvsneg_feedback_z +
                              interview_age
                              , 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(confirmatory3D_mOFC_males$gam)
```

## 3.9 Model: CBCL internalizing factor ~ BIS-BAS-RR
### Females
```{r, echo = FALSE}
dataformodel <- data_no_bisbas_outliers_females

exploratory3A_females <- gamm4(cbcl_scr_syn_internal_r ~ bisbas_ss_basm_rr +
                              interview_age
                              , 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(exploratory3A_females$gam)

```
### Males
```{r, echo = FALSE}
dataformodel <- data_no_bisbas_outliers_males

exploratory3A_males <- gamm4(cbcl_scr_syn_internal_r ~ bisbas_ss_basm_rr +
                              interview_age
                              , 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(exploratory3A_males$gam)

```


## 3.10 Model: CBCL internalizing factor ~ MID Reaction Time
### Females
```{r, echo = FALSE}

# Large reward vs. neutral trial reaction time.
dataformodel <- data_no_RT_MID_outliers_females

exploratory3B_females_largereward_neutral <- gamm4(cbcl_scr_syn_internal_r ~ rt_diff_large_neutral_z +
                              interview_age
                              , 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(exploratory3B_females_largereward_neutral$gam)

# Large reward vs. small reward trial reaction time.
dataformodel <- data_no_RT_MID_outliers_females

exploratory3B_females_largesmallreward <- gamm4(cbcl_scr_syn_internal_r ~ rt_diff_large_small_z +
                              interview_age
                              , 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(exploratory3B_females_largesmallreward$gam)

```
### Males
```{r, echo = FALSE}

# Large reward vs. neutral trial reaction time.
dataformodel <- data_no_RT_MID_outliers_males

exploratory3B_males_largereward_neutral <- gamm4(cbcl_scr_syn_internal_r ~ rt_diff_large_neutral_z +
                              interview_age
                              , 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(exploratory3B_males_largereward_neutral$gam)

# Large reward vs. small reward trial reaction time.
dataformodel <- data_no_RT_MID_outliers_males

exploratory3B_males_largesmallreward <- gamm4(cbcl_scr_syn_internal_r ~ rt_diff_large_small_z +
                              interview_age
                              , 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(exploratory3B_males_largesmallreward$gam)
```

# 4---Internalizing~Puberty x Reward---

## 4.1 Model: CBCL internalizing factor ~ PDS x Accumbens activity (anticipation stage)
### Females
```{r, echo = FALSE}

dataformodel <- data_no_accumbens_ant_outliers_females

confirmatory4_accumbens_ant_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            accumbens_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4_accumbens_ant_females$gam)
#plot_model(confirmatory4_accumbens_ant_females,type = "int", show.data = TRUE) #Interaction plot
```

### Males
```{r, echo = FALSE}

dataformodel <- data_no_accumbens_ant_outliers_males 

confirmatory4_accumbens_ant_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            accumbens_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4_accumbens_ant_males$gam)
# plot_model(confirmatory4_accumbens_ant_males,type = "int", show.data = TRUE) #Interaction plot
```

## 4.2 Model: CBCL internalizing factor ~ PDS x Caudate activity (anticipation stage)
### Females
```{r, echo = FALSE}

dataformodel <- data_no_caudate_ant_outliers_females

confirmatory4_caudate_ant_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            caudate_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4_caudate_ant_females$gam)
#plot_model(confirmatory4_caudate_ant_females,type = "int", show.data = TRUE) #Interaction plot
```

### Males
```{r, echo = FALSE}

dataformodel <- data_no_caudate_ant_outliers_males

confirmatory4_caudate_ant_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            caudate_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4_caudate_ant_males$gam)
#plot_model(confirmatory4_caudate_ant_females,type = "int", show.data = TRUE) #Interaction plot
```


## 4.3 Model: CBCL internalizing factor ~ PDS x Putamen activity (anticipation stage)
### Females
```{r, echo = FALSE}

dataformodel <- data_no_putamen_ant_outliers_females

confirmatory4_putamen_ant_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            putamen_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4_putamen_ant_females$gam)
#plot_model(confirmatory4_caudate_ant_females,type = "int", show.data = TRUE) #Interaction plot
```

### Males
```{r, echo = FALSE}

dataformodel <- data_no_putamen_ant_outliers_males

confirmatory4_putamen_ant_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            putamen_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4_putamen_ant_males$gam)
#plot_model(confirmatory4_caudate_ant_females,type = "int", show.data = TRUE) #Interaction plot
```
## 4.4 Model: CBCL internalizing factor ~ PDS x Lateral OFC activity (anticipation stage)
### Females
```{r, echo = FALSE}
#Lateral OFC anticipation, FEMALES

dataformodel <- data_no_lOFC_ant_outliers_females

exploratory4b_OFC_ant_allCBCL_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            lOFC_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4b_OFC_ant_allCBCL_females$gam )
```

### Males
```{r, echo = FALSE}
#Lateral OFC anticipation, MALES

dataformodel <- data_no_lOFC_ant_outliers_males

exploratory4b_OFC_ant_allCBCL_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            lOFC_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4b_OFC_ant_allCBCL_males$gam )

```

## 4.5 Model: CBCL internalizing factor ~ PDS x Medial OFC activity (anticipation stage)
### Females
```{r, echo=FALSE}
#Medial OFC anticipation, FEMALES

dataformodel <- data_no_mOFC_ant_outliers_females

exploratory4b_mOFC_ant_allCBCL_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            mOFC_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                           interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4b_mOFC_ant_allCBCL_females$gam )
```

### Males
```{r, echo=FALSE}
#Medial OFC anticipation, MALES

dataformodel <- data_no_mOFC_ant_outliers_males

exploratory4b_mOFC_ant_allCBCL_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            mOFC_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4b_mOFC_ant_allCBCL_males$gam )
```



## 4.6 Model: CBCL internalizing factor ~ PDS x Accumbens activity (feedback)
### Females
```{r, echo = FALSE}
#Accumbens feedback, females
dataformodel <- data_no_accumbens_feed_outliers_females

exploratory4a_accumbens_feedback_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            accumbens_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())
summary(exploratory4a_accumbens_feedback_females$gam )
```
### Males
```{r, echo = FALSE}
#Accumbens feedback, males

dataformodel <- data_no_accumbens_feed_outliers_males

exploratory4a_accumbens_feedback_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            accumbens_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())
summary(exploratory4a_accumbens_feedback_males$gam )
```

## 4.7 Model: CBCL internalizing factor ~ PDS x Caudate activity (feedback)
### Females
```{r, echo = FALSE}

dataformodel <- data_no_caudate_feed_outliers_females

exploratory4a_caudate_feedback_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            caudate_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())
summary(exploratory4a_caudate_feedback_females$gam )
```

### Males
```{r, echo = FALSE}

dataformodel <- data_no_caudate_feed_outliers_males

exploratory4a_caudate_feedback_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            caudate_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())
summary(exploratory4a_caudate_feedback_males$gam )
```

## 4.8 Model: CBCL internalizing factor ~ PDS x Putamen activity (feedback)
### Females
```{r, echo = FALSE}

dataformodel <- data_no_putamen_feed_outliers_females

exploratory4a_putamen_feedback_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            putamen_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())
summary(exploratory4a_putamen_feedback_females$gam )
```

### Males
```{r, echo = FALSE}
#Putamen feedback", males

dataformodel <- data_no_putamen_feed_outliers_males

exploratory4a_putamen_feedback_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            putamen_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())
summary(exploratory4a_putamen_feedback_males$gam )
```




## 4.9 Model: CBCL internalizing factor ~ PDS x Lateral OFC activity (feedback stage)
### Females
```{r, echo = FALSE}
#Lateral OFC feedback, FEMALES

dataformodel <- data_no_lOFC_feed_outliers_females

exploratory4b_OFC_feed_allCBCL_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            lOFC_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                           interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4b_OFC_feed_allCBCL_females$gam )
```

### Males
```{r, echo = FALSE}
#Lateral OFC feedback, MALES

dataformodel <- data_no_lOFC_feed_outliers_males

exploratory4b_OFC_feed_allCBCL_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            lOFC_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4b_OFC_feed_allCBCL_males$gam )
```

## 4.10 Model: CBCL internalizing factor ~ PDS x Medial OFC activity (feedback stage)
### Females
```{r, echo=FALSE}
#Medial OFC Feedback, FEMALES
dataformodel <- data_no_mOFC_feed_outliers_females

exploratory4b_mOFC_feed_allCBCL_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            mOFC_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4b_mOFC_feed_allCBCL_females$gam )
```


### Males
```{r, echo=FALSE}
#Medial OFC feedback, MALES

dataformodel <- data_no_mOFC_feed_outliers_males

exploratory4b_mOFC_feed_allCBCL_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            mOFC_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4b_mOFC_feed_allCBCL_males$gam )
```


## 4.11 Model: CBCL internalizing factor ~ PDS x BIS-BAS
### Females
```{r, echo = FALSE}

dataformodel <- data_no_bisbas_outliers_females

exploratory4c_bisbas_allCBCL_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            bisbas_ss_basm_rr+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())
summary(exploratory4c_bisbas_allCBCL_females$gam )
```

### Males
```{r, echo = FALSE}
dataformodel <- data_no_bisbas_outliers_males

exploratory4c_bisbas_allCBCL_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            bisbas_ss_basm_rr+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())
summary(exploratory4c_bisbas_allCBCL_males$gam)

```


## 4.12 Model: CBCL internalizing factor ~ PDS x MID reaction time (large reward vs. neutral)
### Females
```{r, echo = FALSE}

dataformodel <- data_no_RT_MID_outliers_females

#Large reward vs. neutral positive.
exploratory4c_lg_neutral_RT_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            rt_diff_large_neutral_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4c_lg_neutral_RT_females$gam)
```

### Males
```{r, echo=FALSE}
dataformodel <- data_no_RT_MID_outliers_males

#Large reward vs. neutral positive.
exploratory4c_lg_neutral_RT_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            rt_diff_large_neutral_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4c_lg_neutral_RT_males$gam)
```


## 4.13 Model: CBCL internalizing factor ~ PDS x MID reaction time (large vs. small reward)
### Females
```{r, echo = FALSE}
dataformodel <- data_no_RT_MID_outliers_females

#Large reward vs. small reward positive.
exploratory4c_lg_small_RT_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            rt_diff_large_small_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4c_lg_small_RT_females$gam)
```

### Males
```{r, echo=FALSE}
dataformodel <- data_no_RT_MID_outliers_males

#Large reward vs. small reward positive.
exploratory4c_lg_small_RT_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            rt_diff_large_small_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                           interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4c_lg_small_RT_males$gam)
```


## 4.14 Model: CBCL internalizing factor ~ Testosterone x Accumbens activity (anticipation stage) + PDS
### Females
```{r, echo = FALSE}

dataformodel <- data_no_accumbens_ant_no_test_outliers_females

confirmatory4Ea_accumbens_test_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            accumbens_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4Ea_accumbens_test_females $gam)
#plot_model(confirmatory4_accumbens_ant_females,type = "int", show.data = TRUE) #Interaction plot
```
### Males
```{r, echo = FALSE}

dataformodel <- data_no_accumbens_ant_no_test_outliers_males

confirmatory4Ea_accumbens_test_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            accumbens_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4Ea_accumbens_test_males $gam)
#plot_model(confirmatory4_accumbens_ant_females,type = "int", show.data = TRUE) #Interaction plot
```

## 4.15 Model: CBCL internalizing factor ~ Testosterone x Caudate activity (anticipation stage) + PDS
### Females
```{r, echo = FALSE}

dataformodel <- data_no_caudate_ant_no_test_outliers_females

confirmatory4Ea_caudate_test_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            caudate_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4Ea_caudate_test_females $gam)
#plot_model(confirmatory4_accumbens_ant_females,type = "int", show.data = TRUE) #Interaction plot
```

### Males
```{r, echo = FALSE}

dataformodel <- data_no_caudate_ant_no_test_outliers_males

confirmatory4Ea_caudate_test_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            caudate_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4Ea_caudate_test_males $gam)
```

## 4.16 Model: CBCL internalizing factor ~ Testosterone x Putamen activity (anticipation stage) + PDS
### Females
```{r, echo = FALSE}

dataformodel <- data_no_putamen_ant_no_test_outliers_females

confirmatory4Ea_putamen_test_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            putamen_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4Ea_putamen_test_females $gam)
```

### Males
```{r, echo = FALSE}

dataformodel <- data_no_putamen_ant_no_test_outliers_males

confirmatory4Ea_putamen_test_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            putamen_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4Ea_putamen_test_males $gam)
```


## 4.17 Model: CBCL internalizing factor ~ Testosterone x Accumbens activity (feedback stage) + PDS
### Females
```{r, echo = FALSE}

dataformodel <- data_no_accumbens_feed_no_test_outliers_females

exploratory4Eb_accumbens_test_feed_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            accumbens_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4Eb_accumbens_test_feed_females$gam)

```
### Males
```{r, echo = FALSE}

dataformodel <- data_no_accumbens_feed_no_test_outliers_males

exploratory4Eb_accumbens_test_feed_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            accumbens_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4Eb_accumbens_test_feed_males$gam)
```

## 4.18 Model: CBCL internalizing factor ~ Testosterone x Caudate activity (Feedback stage) + PDS
### Females
```{r, echo = FALSE}
dataformodel <- data_no_caudate_feed_no_test_outliers_females

confirmatory4Eb_caudate_test_feed_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            caudate_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4Eb_caudate_test_feed_females$gam)
```

### Males
```{r, echo = FALSE}

dataformodel <- data_no_caudate_feed_no_test_outliers_males

confirmatory4Eb_caudate_test_feed_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            caudate_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4Eb_caudate_test_feed_males$gam)
```

## 4.19 Model: CBCL internalizing factor ~ Testosterone x Putamen activity (Feedback stage) + PDS
### Females
```{r, echo = FALSE}
dataformodel <- data_no_putamen_feed_no_test_outliers_females

confirmatory4Eb_putamen_test_feed_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            putamen_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4Eb_putamen_test_feed_females$gam)

```

### Males
```{r, echo = FALSE}

dataformodel <- data_no_putamen_feed_outliers_no_test_males

confirmatory4Eb_putamen_test_feed_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            putamen_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4Eb_putamen_test_feed_males$gam)
```

## 4.20 Model: CBCL internalizing factor ~ Testosterone x Lateral OFC activity (anticipation stage) + PDS
### Females
```{r, echo=FALSE}
#Lateral OFC

dataformodel <- data_no_lOFC_ant_test_outliers_females 

exploratory4c_OFC_ant_allCBCL_test_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            lOFC_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4c_OFC_ant_allCBCL_test_females$gam )
```

### Males
```{r, echo=FALSE}
#Lateral OFC
dataformodel <- data_no_lOFC_ant_test_outliers_males 

exploratory4c_OFC_ant_allCBCL_test_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                           PDS_score+
                            hormone_scr_ert_mean*  
                            lOFC_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4c_OFC_ant_allCBCL_test_males$gam )
```


## 4.21 Model: CBCL internalizing factor ~ Testosterone x Medial OFC activity (anticipation stage) + PDS
### Females
```{r, echo=FALSE}
#Medial OFC
dataformodel <- data_no_mOFC_ant_test_outliers_females 

exploratory4c_mOFC_ant_allCBCL_test_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            mOFC_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4c_mOFC_ant_allCBCL_test_females$gam )
```

### Males
```{r, echo=FALSE}
#Medial OFC
dataformodel <- data_no_mOFC_ant_test_outliers_males 

exploratory4c_mOFC_ant_allCBCL_test_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                           PDS_score+
                            hormone_scr_ert_mean*  
                            mOFC_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4c_mOFC_ant_allCBCL_test_males$gam )
```

## 4.22 Model: CBCL internalizing factor ~ Testosterone x Lateral OFC activity (feedback stage) + PDS
### Females
```{r, echo = FALSE}
#Lateral OFC feedback

dataformodel <- data_no_lOFC_feed_test_outliers_females 

exploratory4d_OFC_feed_allCBCL_test_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean* 
                            lOFC_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4d_OFC_feed_allCBCL_test_females$gam )
```

### Males
```{r, echo = FALSE}
#Lateral OFC feedback

dataformodel <- data_no_lOFC_feed_test_outliers_males 

exploratory4d_OFC_feed_allCBCL_test_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean* 
                            lOFC_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4d_OFC_feed_allCBCL_test_males$gam )
```

## 4.23 Model: CBCL internalizing factor ~ Testosterone x Medial OFC activity (feedback stage) + PDS
### Females
```{r, echo=FALSE}
#Medial OFC feedback

dataformodel <- data_no_mOFC_feed_test_outliers_females 

exploratory4d_mOFC_feed_allCBCL_test_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean* 
                            mOFC_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4d_mOFC_feed_allCBCL_test_females$gam )
```

### Males
```{r, echo=FALSE}
#Medial OFC feedback

dataformodel <- data_no_mOFC_feed_test_outliers_males 

exploratory4d_mOFC_feed_allCBCL_test_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean* 
                            mOFC_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4d_mOFC_feed_allCBCL_test_males$gam )

```


## 4.24 Model: CBCL internalizing factor ~ Testosterone x BIS-BAS RR + PDS
### Females
```{r, echo = FALSE}

dataformodel <- data_no_bisbas_test_outliers_females 

exploratory4e_bisbas_allCBCL_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*
                            bisbas_ss_basm_rr+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())
summary(exploratory4e_bisbas_allCBCL_females$gam )
```

### Males
```{r, echo = FALSE}

dataformodel <- data_no_bisbas_test_outliers_males 

exploratory4e_bisbas_allCBCL_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*
                            bisbas_ss_basm_rr+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                           interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())
summary(exploratory4e_bisbas_allCBCL_males$gam )
```


## 4.25 Model: CBCL internalizing factor ~ Testosterone x MID Reaction Time + PDS (large reward vs. neutral) 
### Females 
```{r, echo = FALSE}

dataformodel <- data_no_RT_test_outliers_females

#Large reward vs. neutral.
exploratoryFa_lg_neutral_RT_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*
                            rt_diff_large_neutral_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratoryFa_lg_neutral_RT_females$gam)
```
### Males 
```{r, echo = FALSE}
dataformodel <- data_no_RT_test_outliers_males

#Large reward vs. neutral.
exploratoryFa_lg_neutral_RT_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*
                            rt_diff_large_neutral_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratoryFa_lg_neutral_RT_males$gam)
```



## 4.26 Model: CBCL internalizing factor ~ Testosterone x MID Reaction Time + PDS (large vs. small reward)
### Females 
```{r, echo = FALSE}
#Large reward vs. small reward positive.
dataformodel <- data_no_RT_test_outliers_females

exploratoryFb_lg_small_RT_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*
                            rt_diff_large_small_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratoryFb_lg_small_RT_females$gam)
```

### Males
```{r, echo = FALSE}
#Large reward vs. small reward positive.

dataformodel <- data_no_RT_test_outliers_males

exploratoryFb_lg_small_RT_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*
                            rt_diff_large_small_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratoryFb_lg_small_RT_males$gam)
```

# 5--- Correlation Matrix ---
## Females
```{r,echo = FALSE,cols.print=5}
# Remove outliers from the variables that we removed outliers for in the analyses.
# From the manuscript: Outliers were defined as values ≥3 standard deviations away from the mean (based on z-scores calculated after exclusion criteria were taken into account). Outliers were removed for BAS-RR, neuroimaging data, MID reaction time data (Pizzagalli et al., 2009), and testosterone scores (Herting et al., 2021). No outliers were excluded based on z-scores for CBCL because (1) variable-specific inclusion criteria were already taken into account when calculating scores for these variables and (2) even the more extreme values were deemed as within plausible range for these variables.

# Only keep variables that are going into the matrix.
# Note: We are including BMI here as well, even though that is technically from the sensitivity analysis (Supplements C and D).

# Note: Use z scored version instead for most of these.
# Use dataframe that has z scored reaction time difference scores and merge that with PDS_correct.

cor_female <- MID_task_correct_females %>% dplyr::select("src_subject_id","rt_diff_large_neutral_z","rt_diff_large_small_z") 
cor_female <- merge(PDS_correct_females,cor_female, by = "src_subject_id",all.x=TRUE)

cor_female <- cor_female  %>% 
  dplyr::select(#"src_subject_id",
                "interview_age",
                "bmi",
                "PDS_score",
                "hormone_scr_ert_mean_z",
                "bisbas_ss_basm_rr_z",
                "rt_diff_large_neutral_z",
                "rt_diff_large_small_z",
                "cbcl_scr_syn_internal_r",
                "accumbens_rvsn_ant_z", # Accumbens reward vs. neutral anticipation.
                "caudate_rvsn_ant_z", # Caudate reward vs. neutral anticipation.
                "putamen_rvsn_ant_z", # Putamen reward vs. neutral anticipation.
                "mOFC_rvsn_ant_z", # Medial OFC reward vs. neutral anticipation.
                "lOFC_rvsn_ant_z", # Lateral OFC reward vs. neutral anticipation.
                "accumbens_posvsneg_feedback_z", # Accumbens reward positive versus negative feedback.
                "caudate_posvsneg_feedback_z", # Caudate reward positive versus negative feedback.
                "putamen_posvsneg_feedback_z", # Putamen reward positive versus negative feedback.
                "mOFC_posvsneg_feedback_z",  # Medial OFC reward positive versus negative feedback.
                "lOFC_posvsneg_feedback_z") # Lateral OFC reward positive versus negative feedback.

#dim(cor_female) # 2701 rows,  18 columns.
# All of the z score ones need to be cleaned so that if it is < -3 or >3, it is replaced with NA instead.

#variables_without_outliers <- c("src_subject_id",
#                "interview_age",
#                "sex",
#                "bmi",
#                "PDS_score",
#                "cbcl_scr_syn_internal_r")
                
variables_with_outliers <- c("hormone_scr_ert_mean_z",
                "bisbas_ss_basm_rr_z",
                "rt_diff_large_neutral_z",
                "rt_diff_large_small_z",
                "accumbens_rvsn_ant_z", # Accumbens reward vs. neutral anticipation.
                "caudate_rvsn_ant_z", # Caudate reward vs. neutral anticipation.
                "putamen_rvsn_ant_z", # Putamen reward vs. neutral anticipation.
                "mOFC_rvsn_ant_z", # Medial OFC reward vs. neutral anticipation.
                "lOFC_rvsn_ant_z", # Lateral OFC reward vs. neutral anticipation.
                "accumbens_posvsneg_feedback_z", # Accumbens reward positive versus negative feedback.
                "caudate_posvsneg_feedback_z", # Caudate reward positive versus negative feedback.
                "putamen_posvsneg_feedback_z", # Putamen reward positive versus negative feedback.
                "mOFC_posvsneg_feedback_z",  # Medial OFC reward positive versus negative feedback.
                "lOFC_posvsneg_feedback_z") # Lateral OFC reward positive versus negative feedback.

#dim(cor_female_variables_without_outliers)
#dim(cor_female_variables_with_outliers)

#sum(is.na(cor_female$caudate_posvsneg_feedback_z)) # 445.
#sum(cor_female$caudate_posvsneg_feedback_z > 3, na.rm = TRUE) # 9.
#sum(cor_female$caudate_posvsneg_feedback_z < -3, na.rm = TRUE) # 10.
# So after this step it should be 445+9 = 464.

# This is a two step process: First,  across all columns, replace all z scores greater than 3 or less than -3 with -99.
# Then, replace all -99 with "NA".
cor_female[ ,variables_with_outliers][ cor_female[ ,variables_with_outliers] > 3] <- -99
cor_female[ ,variables_with_outliers][ cor_female[ ,variables_with_outliers] < -3] <- -99
cor_female <- cor_female %>% replace_with_na_all(condition = ~.x == -99)
#sum(is.na(cor_female$caudate_posvsneg_feedback_z)) # 464.

# Now make correlation matrix!
# Function from: http://www.sthda.com/english/wiki/correlation-matrix-a-quick-start-guide-to-analyze-format-and-visualize-a-correlation-matrix-using-r-software#compute-correlation-matrix-in-r
# ++++++++++++++++++++++++++++
# flattenCorrMatrix
# ++++++++++++++++++++++++++++
# cormat : matrix of the correlation coefficients
# pmat : matrix of the correlation p-values
flattenCorrMatrix <- function(cormat, pmat,nmat) {
  ut <- upper.tri(cormat)
  data.frame(
    x1 = rownames(cormat)[col(cormat)[ut]],
    x2= rownames(cormat)[row(cormat)[ut]],
    N = nmat[ut],
    corr  =(cormat)[ut],
    p = pmat[ut]
    )
}

cormat_females <- rcorr(as.matrix(cor_female))
cormat_females_flat <- flattenCorrMatrix(cormat_females$r, cormat_females$P,cormat_females$n)
#cormat_females_flat
#print(format(cormat_females_flat, scientific = F))
knitr::kable(format(cormat_females_flat, scientific = F))


```
## Males
```{r,echo = FALSE,cols.print=5}

cor_male <- MID_task_correct_males %>% dplyr::select("src_subject_id","rt_diff_large_neutral_z","rt_diff_large_small_z") 
cor_male <- merge(PDS_correct_males,cor_male, by = "src_subject_id",all.x=TRUE)

cor_male <- cor_male  %>% 
  dplyr::select(#"src_subject_id",
                "interview_age",
                "bmi",
                "PDS_score",
                "hormone_scr_ert_mean_z",
                "bisbas_ss_basm_rr_z",
                "rt_diff_large_neutral_z",
                "rt_diff_large_small_z",
                "cbcl_scr_syn_internal_r",
                "accumbens_rvsn_ant_z", # Accumbens reward vs. neutral anticipation.
                "caudate_rvsn_ant_z", # Caudate reward vs. neutral anticipation.
                "putamen_rvsn_ant_z", # Putamen reward vs. neutral anticipation.
                "mOFC_rvsn_ant_z", # Medial OFC reward vs. neutral anticipation.
                "lOFC_rvsn_ant_z", # Lateral OFC reward vs. neutral anticipation.
                "accumbens_posvsneg_feedback_z", # Accumbens reward positive versus negative feedback.
                "caudate_posvsneg_feedback_z", # Caudate reward positive versus negative feedback.
                "putamen_posvsneg_feedback_z", # Putamen reward positive versus negative feedback.
                "mOFC_posvsneg_feedback_z",  # Medial OFC reward positive versus negative feedback.
                "lOFC_posvsneg_feedback_z") # Lateral OFC reward positive versus negative feedback.

#dim(cor_male) # 2986 rows,  18 columns.
# All of the z score ones need to be cleaned so that if it is < -3 or >3, it is replaced with NA instead.
                
variables_with_outliers <- c("hormone_scr_ert_mean_z",
                "bisbas_ss_basm_rr_z",
                "rt_diff_large_neutral_z",
                "rt_diff_large_small_z",
                "accumbens_rvsn_ant_z", # Accumbens reward vs. neutral anticipation.
                "caudate_rvsn_ant_z", # Caudate reward vs. neutral anticipation.
                "putamen_rvsn_ant_z", # Putamen reward vs. neutral anticipation.
                "mOFC_rvsn_ant_z", # Medial OFC reward vs. neutral anticipation.
                "lOFC_rvsn_ant_z", # Lateral OFC reward vs. neutral anticipation.
                "accumbens_posvsneg_feedback_z", # Accumbens reward positive versus negative feedback.
                "caudate_posvsneg_feedback_z", # Caudate reward positive versus negative feedback.
                "putamen_posvsneg_feedback_z", # Putamen reward positive versus negative feedback.
                "mOFC_posvsneg_feedback_z",  # Medial OFC reward positive versus negative feedback.
                "lOFC_posvsneg_feedback_z") # Lateral OFC reward positive versus negative feedback.

#dim(cor_male_variables_without_outliers)
#dim(cor_male_variables_with_outliers)

#sum(is.na(cor_male$caudate_posvsneg_feedback_z)) # 553.
#sum(cor_male$caudate_posvsneg_feedback_z > 3, na.rm = TRUE) # 22.
#sum(cor_male$caudate_posvsneg_feedback_z < -3, na.rm = TRUE) # 18.
# So after this step it should be 553+22+18 = 593.

# This is a two step process: First,  across all columns, replace all z scores greater than 3 or less than -3 with -99.
# Then, replace all -99 with "NA".
cor_male[ ,variables_with_outliers][ cor_male[ ,variables_with_outliers] > 3] <- -99
cor_male[ ,variables_with_outliers][ cor_male[ ,variables_with_outliers] < -3] <- -99
cor_male <- cor_male %>% replace_with_na_all(condition = ~.x == -99)
#sum(is.na(cor_male$caudate_posvsneg_feedback_z)) # 593.

# Now make correlation matrix!
cormat_males <- rcorr(as.matrix(cor_male))
cormat_males_flat <- flattenCorrMatrix(cormat_males$r, cormat_males$P,cormat_males$n)
#cormat_males_flat
#print(format(cormat_males_flat, scientific = F, digits = 3))
knitr::kable(format(cormat_males_flat, scientific = F))

```