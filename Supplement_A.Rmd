---
title: 'Supplement A'
subtitle: 'Reward sensitivity and internalizing symptoms during the transition to puberty: An examination of 9- and 10-year-olds in the ABCD Study.'
output:
  pdf_document:
    toc: yes
    toc_depth: '3'
    df_print: paged
  html_document:
    toc: yes
    toc_depth: '3'
    toc_float:
      collapsed: true
    df_print: paged
---

```{r loadPackages, echo = FALSE, message=FALSE, warning=FALSE, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(ggplot2)
library(gamm4)
library(dplyr)
library(here)
library(lmerTest)
library(gamm4.test)
library(naniar) # For replacing certain values with "NA" instead.
library(Hmisc) # for correlation matrix.
library(compareGroups)

data_dir = ((dirname(here()))) 

phase_folder = "exploratory"  # select the appropriate folder.

data_folder <- file.path(data_dir,"ABCD","derivatives",phase_folder)

file_name <- "nda30_exploratory.csv" # specify file name here. 

fulldata <- read.csv(file.path(data_folder,file_name))
nrow(fulldata) # 27321 (exploratory); 27331 (confirmatory). When call the define_dataframes script, will keep only the baseline data.

# Call function to define all of the dataframes.
script_path <- file.path(data_dir,"rewardprocesses_internalizing_puberty_exploratory","code","define_dataframes.R")
source(script_path)

# Define function to get standardized coefficients.
standardized_coefficient_function <- file.path(data_dir,
                                          "rewardprocesses_internalizing_puberty_exploratory",
                                          "code",
                                          "get_standardized_coefficients.R")
source(standardized_coefficient_function) # function is standardized_coefficient.

# Demographics

min(PDS_correct$interview_age)
max(PDS_correct$interview_age)
mean(PDS_correct$interview_age)
nrow(PDS_correct) # 5625 (exploratory).
female_subset <- subset(PDS_correct, sex=="F")
male_subset <- subset(PDS_correct, sex=="M")

nrow(female_subset)
nrow(male_subset)

library(psych)
describe(female_subset$interview_age)
describe(male_subset$interview_age)

#Female Race & Ethnicity
female_racethnicity_table <- table(female_subset$race.ethnicity.5level)

library(stats)
addmargins(female_racethnicity_table)
sum(is.na(female_subset$race.ethnicity.5level))

#Hispanic or Latina/o/x = 1
female_ethnicity_table <- table(female_subset$demo_race_hispanic)
addmargins(female_ethnicity_table)

#Male Race & Ethnicity
male_racethnicity_table <- table(male_subset$race.ethnicity.5level)
library(stats)
addmargins(male_racethnicity_table)
sum(is.na(male_subset$race.ethnicity.5level))

#Hispanic or Latina/o/x = 1
male_ethnicity_table <- table(male_subset$demo_race_hispanic)
addmargins(male_ethnicity_table)

#PDS Score
describe(female_subset$PDS_score)
describe(male_subset$PDS_score)

#PDS Stage Category
female_pds_category_table <- table(female_subset$pds_p_ss_category)
addmargins(female_pds_category_table)
prop.table(female_pds_category_table)

male_pds_category_table <- table(male_subset$pds_p_ss_category)
addmargins(male_pds_category_table)
prop.table(male_pds_category_table)


#CBCL Internalizing Raw Score
describe(female_subset$cbcl_scr_syn_internal_r)
describe(male_subset$cbcl_scr_syn_internal_r)


#BIS/BAS
describe(data_no_bisbas_outliers_females$bisbas_ss_basm_rr)
describe(data_no_bisbas_outliers_males$bisbas_ss_basm_rr)


#Testosterone
describe(data_no_test_outliers_females$hormone_scr_ert_mean)
describe(data_no_test_outliers_males$hormone_scr_ert_mean)

#BMI
describe(female_subset$bmi)
describe(male_subset$bmi)
```

\newpage
# Results for Sample 1
# 1---Internalizing~Puberty---

## 1.1 Model: CBCL internalizing factor ~ PDS
### Female participants
```{r, echo=FALSE}
dataformodel <- PDS_correct_females

confirmatory2_females <- gamm4(cbcl_scr_syn_internal_r ~ PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))

summary(confirmatory2_females$gam)
print(standardized_coefficient(confirmatory2_females$mer))
```
### Male participants
```{r, echo=FALSE}
dataformodel <- PDS_correct_males

confirmatory2_males <- gamm4(cbcl_scr_syn_internal_r ~ PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
          
summary(confirmatory2_males$gam)
print(standardized_coefficient(confirmatory2_males$mer))
```

## 1.2 Model: CBCL Anxious-Depressed ~ PDS
### Female participants
```{r, echo=FALSE}
dataformodel <- PDS_correct_females

confirmatory2_females <- gamm4(cbcl_scr_syn_anxdep_r ~ PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))

summary(confirmatory2_females$gam)
print(standardized_coefficient(confirmatory2_females$mer))
```
### Male participants
```{r, echo=FALSE}
dataformodel <- PDS_correct_males

confirmatory2_males <- gamm4(cbcl_scr_syn_anxdep_r ~ PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
          
summary(confirmatory2_males$gam)
print(standardized_coefficient(confirmatory2_males$mer))
```
## 1.3 Model: CBCL Withdrawn-Depressed ~ PDS
### Female participants
```{r, echo=FALSE}
dataformodel <- PDS_correct_females

confirmatory2_females <- gamm4(cbcl_scr_syn_withdep_r ~ PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))

summary(confirmatory2_females$gam)
print(standardized_coefficient(confirmatory2_females$mer))
```
### Male participants
```{r, echo=FALSE}
dataformodel <- PDS_correct_males

confirmatory2_males <- gamm4(cbcl_scr_syn_withdep_r ~ PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
          
summary(confirmatory2_males$gam)
print(standardized_coefficient(confirmatory2_males$mer))
```
## 1.4 Model: CBCL Depressed DSM-5 ~ PDS
### Female participants
```{r, echo=FALSE}
dataformodel <- PDS_correct_females

confirmatory2_females <- gamm4(cbcl_scr_dsm5_depress_r ~ PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))

summary(confirmatory2_females$gam)
print(standardized_coefficient(confirmatory2_females$mer))
```
### Male participants
```{r, echo=FALSE}
dataformodel <- PDS_correct_males

confirmatory2_males <- gamm4(cbcl_scr_dsm5_depress_r ~ PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
          
summary(confirmatory2_males$gam)
print(standardized_coefficient(confirmatory2_males$mer))
```



## 1.5 Model: CBCL internalizing factor ~ Pubertal category
### Female participants
```{r, echo=FALSE}
dataformodel <- PDS_correct_females
confirmatory2_category_females <- gamm4(cbcl_scr_syn_internal_r ~ pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
summary(confirmatory2_category_females$gam)
print(standardized_coefficient(confirmatory2_category_females$mer))
```
### Male participants
```{r, echo=FALSE}
dataformodel <- PDS_correct_males
confirmatory2_category_males <- gamm4(cbcl_scr_syn_internal_r ~ pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
summary(confirmatory2_category_males$gam)
print(standardized_coefficient(confirmatory2_category_males$mer))
```

## 1.6 Model: CBCL Anxious-Depressed ~ Pubertal category
### Female participants 
```{r, echo=FALSE}
dataformodel <- PDS_correct_females
confirmatory2_category_females <- gamm4(cbcl_scr_syn_anxdep_r ~ pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
summary(confirmatory2_category_females$gam)
print(standardized_coefficient(confirmatory2_category_females$mer))
```
### Male participants
```{r, echo=FALSE}
dataformodel <- PDS_correct_males
confirmatory2_category_males <- gamm4(cbcl_scr_syn_anxdep_r ~ pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
summary(confirmatory2_category_males$gam)
print(standardized_coefficient(confirmatory2_category_males$mer))
```

## 1.7 Model: CBCL Withdrawn-Depressed ~ Pubertal category
### Female participants
```{r, echo=FALSE}
dataformodel <- PDS_correct_females
confirmatory2_category_females <- gamm4(cbcl_scr_syn_withdep_r ~ pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
summary(confirmatory2_category_females$gam) 
print(standardized_coefficient(confirmatory2_category_females$mer))
```
### Male participants
```{r, echo=FALSE}
dataformodel <- PDS_correct_males
confirmatory2_category_males <- gamm4(cbcl_scr_syn_withdep_r ~ pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
summary(confirmatory2_category_males$gam)
print(standardized_coefficient(confirmatory2_category_males$mer))
```

## 1.8 Model: CBCL Depressed DSM-5 ~ Pubertal category
### Female participants
```{r, echo=FALSE}
dataformodel <- PDS_correct_females
confirmatory2_category_females <- gamm4(cbcl_scr_dsm5_depress_r ~ pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
summary(confirmatory2_category_females$gam)
print(standardized_coefficient(confirmatory2_category_females$mer))
```
### Male participants
```{r, echo=FALSE}
dataformodel <- PDS_correct_males
confirmatory2_category_males <- gamm4(cbcl_scr_dsm5_depress_r ~ pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
summary(confirmatory2_category_males$gam)
print(standardized_coefficient(confirmatory2_category_males$mer))
```



## 1.9 Model: CBCL internalizing factor ~ Testosterone
### Female participants
```{r, echo=FALSE}
dataformodel <- data_no_test_outliers_females

confirmatory2_testosterone_CBCL_female <- gamm4(cbcl_scr_syn_internal_r ~ hormone_scr_ert_mean +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2_testosterone_CBCL_female$gam)
print(standardized_coefficient(confirmatory2_testosterone_CBCL_female$mer))
```
### Male participants
```{r, echo=FALSE}
dataformodel <- data_no_test_outliers_males

confirmatory2_testosterone_CBCL_male <- gamm4(cbcl_scr_syn_internal_r ~ hormone_scr_ert_mean +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2_testosterone_CBCL_male$gam)
print(standardized_coefficient(confirmatory2_testosterone_CBCL_male$mer))
```
## 1.10 Model: CBCL Anxious-Depressed ~ Testosterone
### Female participants
```{r, echo=FALSE}
dataformodel <- data_no_test_outliers_females

confirmatory2_testosterone_CBCL_female <- gamm4(cbcl_scr_syn_anxdep_r ~ hormone_scr_ert_mean +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2_testosterone_CBCL_female$gam)
print(standardized_coefficient(confirmatory2_testosterone_CBCL_female$mer))
```
### Male participants
```{r, echo=FALSE}
dataformodel <- data_no_test_outliers_males

confirmatory2_testosterone_CBCL_male <- gamm4(cbcl_scr_syn_anxdep_r ~ hormone_scr_ert_mean +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2_testosterone_CBCL_male$gam)
print(standardized_coefficient(confirmatory2_testosterone_CBCL_female$mer))
```

## 1.11 Model: CBCL Withdrawn-Depressed ~ Testosterone
### Female participants
```{r, echo=FALSE}
dataformodel <- data_no_test_outliers_females

confirmatory2_testosterone_CBCL_female <- gamm4(cbcl_scr_syn_withdep_r ~ hormone_scr_ert_mean +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2_testosterone_CBCL_female$gam)
print(standardized_coefficient(confirmatory2_testosterone_CBCL_female$mer))
```

### Male participants
```{r, echo=FALSE}
dataformodel <- data_no_test_outliers_males

confirmatory2_testosterone_CBCL_male <- gamm4(cbcl_scr_syn_withdep_r ~ hormone_scr_ert_mean +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2_testosterone_CBCL_male$gam)
print(standardized_coefficient(confirmatory2_testosterone_CBCL_male$mer))
```
## 1.12 Model: CBCL Depressed DSM-5 ~ Testosterone
### Female participants
```{r, echo=FALSE}
dataformodel <- data_no_test_outliers_females

confirmatory2_testosterone_CBCL_female <- gamm4(cbcl_scr_dsm5_depress_r ~ hormone_scr_ert_mean +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2_testosterone_CBCL_female$gam)
print(standardized_coefficient(confirmatory2_testosterone_CBCL_female$mer))
```
### Male participants
```{r, echo=FALSE}
dataformodel <- data_no_test_outliers_males

confirmatory2_testosterone_CBCL_male <- gamm4(cbcl_scr_dsm5_depress_r ~ hormone_scr_ert_mean +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2_testosterone_CBCL_male$gam)
print(standardized_coefficient(confirmatory2_testosterone_CBCL_male$mer))
```


## 1.13 Model: CBCL internalizing factor ~ Testosterone + PDS 
### Female participants
```{r, echo=FALSE}

dataformodel <- data_no_test_outliers_females

confirmatory2B_testosterone_CBCL_female <- gamm4(cbcl_scr_syn_internal_r ~ hormone_scr_ert_mean + PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,  
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_female$gam)
print(standardized_coefficient(confirmatory2B_testosterone_CBCL_female$mer))
```
### Male participants
```{r, echo=FALSE}
dataformodel <- data_no_test_outliers_males 
  

confirmatory2B_testosterone_CBCL_male <- gamm4(cbcl_scr_syn_internal_r ~ hormone_scr_ert_mean + PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_male$gam)
print(standardized_coefficient(confirmatory2B_testosterone_CBCL_male$mer))
```

## 1.14 Model: CBCL internalizing factor ~ Testosterone + Pubertal category 
### Female participants
```{r, echo=FALSE}
# PDS category.

dataformodel <- subset(PDS_correct_females, hormone_scr_ert_mean_z > -3 & hormone_scr_ert_mean_z < 3 & pds_p_ss_category !="5")

confirmatory2B_testosterone_CBCL_female_category <- gamm4(cbcl_scr_syn_internal_r ~ hormone_scr_ert_mean + pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,  
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_female_category$gam)
print(standardized_coefficient(confirmatory2B_testosterone_CBCL_female_category$mer))
```
### Male participants
```{r, echo=FALSE}
# PDS category.

dataformodel <- subset(PDS_correct_males, hormone_scr_ert_mean_z > -3 & hormone_scr_ert_mean_z < 3 & pds_p_ss_category !="5")

confirmatory2B_testosterone_CBCL_male_category <- gamm4(cbcl_scr_syn_internal_r ~ hormone_scr_ert_mean + pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_male_category$gam)
print(standardized_coefficient(confirmatory2B_testosterone_CBCL_male_category$mer))
```
## 1.15 Model: CBCL Anxious-Depressed ~ Testosterone + PDS 
### Female participants
```{r, echo=FALSE}

dataformodel <- data_no_test_outliers_females

confirmatory2B_testosterone_CBCL_female <- gamm4(cbcl_scr_syn_anxdep_r ~ hormone_scr_ert_mean + PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,  
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_female$gam)
print(standardized_coefficient(confirmatory2B_testosterone_CBCL_female$mer))
```
### Male participants
```{r, echo=FALSE}

dataformodel <- data_no_test_outliers_males 
  
confirmatory2B_testosterone_CBCL_male <- gamm4(cbcl_scr_syn_anxdep_r ~ hormone_scr_ert_mean + PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_male$gam)
print(standardized_coefficient(confirmatory2B_testosterone_CBCL_male$mer))
```

## 1.16 Model: CBCL Anxious-Depressed ~ Testosterone + Pubertal category
### Female participants
```{r, echo=FALSE}
# PDS category.

dataformodel <- subset(PDS_correct_females, hormone_scr_ert_mean_z > -3 & hormone_scr_ert_mean_z < 3 & pds_p_ss_category !="5")

confirmatory2B_testosterone_CBCL_female_category <- gamm4(cbcl_scr_syn_anxdep_r ~ hormone_scr_ert_mean + pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,  
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_female_category$gam)
print(standardized_coefficient(confirmatory2B_testosterone_CBCL_female_category$mer))
```
### Male participants
```{r, echo=FALSE}
# PDS category.

dataformodel <- subset(PDS_correct_males, hormone_scr_ert_mean_z > -3 & hormone_scr_ert_mean_z < 3 & pds_p_ss_category !="5")

confirmatory2B_testosterone_CBCL_male_category <- gamm4(cbcl_scr_syn_anxdep_r ~ hormone_scr_ert_mean + pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_male_category$gam)
print(standardized_coefficient(confirmatory2B_testosterone_CBCL_male_category$mer))
```
## 1.17 Model: CBCL Withdrawn-Depressed ~ Testosterone + PDS
### Female participants
```{r, echo=FALSE}

dataformodel <- data_no_test_outliers_females

confirmatory2B_testosterone_CBCL_female <- gamm4(cbcl_scr_syn_withdep_r ~ hormone_scr_ert_mean + PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,  
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_female$gam)
print(standardized_coefficient(confirmatory2B_testosterone_CBCL_female$mer))
```
### Male participants
```{r, echo=FALSE}

dataformodel <- data_no_test_outliers_males 
  
confirmatory2B_testosterone_CBCL_male <- gamm4(cbcl_scr_syn_withdep_r ~ hormone_scr_ert_mean + PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_male$gam)
print(standardized_coefficient(confirmatory2B_testosterone_CBCL_male$mer))
```
## 1.18 Model: CBCL Withdrawn-Depressed ~ Testosterone + Pubertal category
### Female participants
```{r, echo=FALSE}
# PDS category.

dataformodel <- subset(PDS_correct_females, hormone_scr_ert_mean_z > -3 & hormone_scr_ert_mean_z < 3 & pds_p_ss_category !="5")

confirmatory2B_testosterone_CBCL_female_category <- gamm4(cbcl_scr_syn_withdep_r ~ hormone_scr_ert_mean + pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,  
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_female_category$gam)
print(standardized_coefficient(confirmatory2B_testosterone_CBCL_female_category$mer))
```
### Male participants
```{r, echo=FALSE}
# PDS category.

dataformodel <- subset(PDS_correct_males, hormone_scr_ert_mean_z > -3 & hormone_scr_ert_mean_z < 3 & pds_p_ss_category !="5")

confirmatory2B_testosterone_CBCL_male_category <- gamm4(cbcl_scr_syn_withdep_r ~ hormone_scr_ert_mean + pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_male_category$gam)
print(standardized_coefficient(confirmatory2B_testosterone_CBCL_male_category$mer))
```
## 1.19 Model: CBCL Depressed DSM-5 ~ Testosterone + PDS 
### Female participants
```{r, echo=FALSE}

dataformodel <- data_no_test_outliers_females

confirmatory2B_testosterone_CBCL_female <- gamm4(cbcl_scr_dsm5_depress_r ~ hormone_scr_ert_mean + PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,  
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_female$gam)
print(standardized_coefficient(confirmatory2B_testosterone_CBCL_female$mer))
```
### Male participants
```{r, echo=FALSE}

dataformodel <- data_no_test_outliers_males 

confirmatory2B_testosterone_CBCL_male <- gamm4(cbcl_scr_dsm5_depress_r ~ hormone_scr_ert_mean + PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_male$gam)
print(standardized_coefficient(confirmatory2B_testosterone_CBCL_male$mer))
```

## 1.20 Model: CBCL Depressed DSM-5 ~ Testosterone + Pubertal category 
### Female participants
```{r, echo=FALSE}
# PDS category.

dataformodel <- subset(PDS_correct_females, hormone_scr_ert_mean_z > -3 & hormone_scr_ert_mean_z < 3 & pds_p_ss_category !="5")

confirmatory2B_testosterone_CBCL_female_category <- gamm4(cbcl_scr_dsm5_depress_r ~ hormone_scr_ert_mean + pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,  
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_female_category$gam)
print(standardized_coefficient(confirmatory2B_testosterone_CBCL_female_category$mer))
```
### Male participants
```{r, echo=FALSE}
# PDS category.

dataformodel <- subset(PDS_correct_males, hormone_scr_ert_mean_z > -3 & hormone_scr_ert_mean_z < 3 & pds_p_ss_category !="5")

confirmatory2B_testosterone_CBCL_male_category <- gamm4(cbcl_scr_dsm5_depress_r ~ hormone_scr_ert_mean + pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_male_category$gam)
print(standardized_coefficient(confirmatory2B_testosterone_CBCL_male_category$mer))
```

\newpage
# 2---Reward~Puberty---

## 2.1 Model: BIS-BAS-RR ~ PDS
### Female participants
```{r, echo = FALSE}
dataformodel <- data_no_bisbas_outliers_females

exploratory1B_females <- gamm4(bisbas_ss_basm_rr_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1B_females$gam)
print(standardized_coefficient(exploratory1B_females$mer))

```
### Male participants
```{r, echo = FALSE}
dataformodel <- data_no_bisbas_outliers_males

exploratory1B_males <- gamm4(bisbas_ss_basm_rr_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1B_males$gam)
print(standardized_coefficient(exploratory1B_males$mer))
```


## 2.2 Model : Reaction Time ~ PDS

### Female participants
```{r, echo = FALSE}
dataformodel <- data_no_RT_MID_outliers_females

# Large reward vs. neutral positive.
exploratory1C_lg_neutral_RT_females <- gamm4(rt_diff_large_neutral_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1C_lg_neutral_RT_females$gam)
print(standardized_coefficient(exploratory1C_lg_neutral_RT_females$mer))

# Large reward vs. small positive.
exploratory1C_lg_small_RT_females <- gamm4(rt_diff_large_small_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1C_lg_small_RT_females$gam)
print(standardized_coefficient(exploratory1C_lg_small_RT_females$mer))
```

### Male participants
```{r, echo = FALSE}
dataformodel <- data_no_RT_MID_outliers_males

# Large reward vs. neutral positive.
exploratory1C_lg_neutral_RT_males <- gamm4(rt_diff_large_neutral_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1C_lg_neutral_RT_males$gam)
print(standardized_coefficient(exploratory1C_lg_neutral_RT_males$mer))

# Large reward vs. small positive.
exploratory1C_lg_small_RT_males <- gamm4(rt_diff_large_small_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1C_lg_small_RT_males$gam)
print(standardized_coefficient(exploratory1C_lg_small_RT_males$mer))
```

## 2.3 Model: Caudate Anticipation ~ PDS
### Female participants
```{r, echo = FALSE}
dataformodel <- data_no_caudate_ant_outliers_females 

confirmatory1_caudate_females <- gamm4(caudate_rvsn_ant_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(confirmatory1_caudate_females$gam)
print(standardized_coefficient(confirmatory1_caudate_females$mer))
```

### Male participants
```{r, echo = FALSE}
dataformodel <- data_no_striatal_ant_outliers_males

confirmatory1_caudate_males<- gamm4(caudate_rvsn_ant_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(confirmatory1_caudate_males$gam)
print(standardized_coefficient(confirmatory1_caudate_males$mer))

```

## 2.4 Model: Putamen Anticipation ~ PDS
### Female participants
```{r, echo = FALSE}
dataformodel <- data_no_putamen_ant_outliers_females 

confirmatory1_putamen_females <- gamm4(putamen_rvsn_ant_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(confirmatory1_putamen_females$gam)
print(standardized_coefficient(confirmatory1_putamen_females$mer))

```

### Male participants
```{r, echo = FALSE}
dataformodel <- data_no_putamen_ant_outliers_males 

confirmatory1_putamen_males <- gamm4(putamen_rvsn_ant_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(confirmatory1_putamen_males$gam)
print(standardized_coefficient(confirmatory1_putamen_males$mer))
```

## 2.5 Model: Accumbens Anticipation ~ PDS
### Female participants
```{r, echo = FALSE}
dataformodel <- data_no_accumbens_ant_outliers_females 

confirmatory1_accumbens_females <- gamm4(accumbens_rvsn_ant_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(confirmatory1_accumbens_females$gam)
print(standardized_coefficient(confirmatory1_accumbens_females$mer))

```

### Male participants
```{r, echo = FALSE}
dataformodel <- data_no_accumbens_ant_outliers_males 

confirmatory1_accumbens_males <- gamm4(accumbens_rvsn_ant_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(confirmatory1_accumbens_males$gam)
print(standardized_coefficient(confirmatory1_accumbens_males$mer))

```


## 2.6 Model: Caudate Feedback  ~ PDS
### Female participants
```{r, echo = FALSE}
dataformodel <- data_no_caudate_feed_outliers_females

exploratory1A_caudate_females <- gamm4(caudate_posvsneg_feedback_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1A_caudate_females$gam)
print(standardized_coefficient(exploratory1A_caudate_females$mer))

```

### Male participants
```{r, echo = FALSE}
dataformodel <- data_no_caudate_feed_outliers_males

exploratory1A_caudate_males <- gamm4(caudate_posvsneg_feedback_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1A_caudate_males$gam)
print(standardized_coefficient(exploratory1A_caudate_males$mer))

```
## 2.7 Model: Putamen Feedback ~ PDS
### Female participants
```{r, echo = FALSE}
dataformodel <- data_no_putamen_feed_outliers_females

exploratory1A_putamen_females <- gamm4(putamen_posvsneg_feedback_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1A_putamen_females$gam)
print(standardized_coefficient(exploratory1A_putamen_females$mer))

```

### Male participants
```{r, echo = FALSE}
dataformodel <- data_no_putamen_feed_outliers_males

exploratory1A_putamen_males <- gamm4(putamen_posvsneg_feedback_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1A_putamen_males$gam)
print(standardized_coefficient(exploratory1A_putamen_males$mer))

```
## 2.8 Model: Accumbens Feedback ~ PDS
### Female participants
```{r, echo = FALSE}
dataformodel <- data_no_accumbens_feed_outliers_females

exploratory1A_accumbens_females <- gamm4(accumbens_posvsneg_feedback_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1A_accumbens_females$gam)
print(standardized_coefficient(exploratory1A_accumbens_females$mer))

```

### Male participants
```{r, echo = FALSE}
dataformodel <- data_no_accumbens_feed_outliers_males

exploratory1A_accumbens_males <- gamm4(accumbens_posvsneg_feedback_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1A_accumbens_males$gam)
print(standardized_coefficient(exploratory1A_accumbens_males$mer))

```
## 2.9 Model: OFC Anticipation ~ PDS
### Female participants
```{r, echo = FALSE}

# Female participants (lateral OFC; lOFC).
dataformodel <- data_no_lOFC_ant_outliers_females
modelC_females_lOFC <- gamm4(lOFC_rvsn_ant_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelC_females_lOFC$gam)
print(standardized_coefficient(modelC_females_lOFC$mer))

# Female participants (medial OFC; mOFC).
dataformodel <- data_no_mOFC_ant_outliers_females
modelC_females_mOFC <- gamm4(mOFC_rvsn_ant_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelC_females_mOFC$gam)
print(standardized_coefficient(modelC_females_mOFC$mer))
```
### Male participants
```{r, echo=FALSE}
# Male participants (lateral OFC; lOFC).
dataformodel <- data_no_lOFC_ant_outliers_males
modelC_males_lOFC <- gamm4(lOFC_rvsn_ant_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelC_males_lOFC$gam)
print(standardized_coefficient(modelC_males_lOFC$mer))

# Male participants (medial OFC; mOFC).
dataformodel <- data_no_mOFC_ant_outliers_males
modelC_males_mOFC <- gamm4(mOFC_rvsn_ant_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelC_males_mOFC$gam)
print(standardized_coefficient(modelC_males_mOFC$mer))
```

## 2.10 Model: OFC Feedback ~ PDS
### Female participants
```{r, echo = FALSE}
# Female participants (lateral OFC; lOFC).
dataformodel <- data_no_lOFC_feed_outliers_females
modelD_females_lOFC <- gamm4(lOFC_posvsneg_feedback_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelD_females_lOFC$gam)
print(standardized_coefficient(modelD_females_lOFC$mer))


# Female participants (medial OFC; mOFC).
dataformodel <- data_no_mOFC_feed_outliers_females
modelD_females_mOFC <- gamm4(mOFC_posvsneg_feedback_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelD_females_mOFC$gam)
print(standardized_coefficient(modelD_females_mOFC$mer))
```

### Male participants
```{r, echo=FALSE}
# Male participants (lateral OFC; lOFC).
dataformodel <- data_no_lOFC_feed_outliers_males
modelD_males_lOFC <- gamm4(lOFC_posvsneg_feedback_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelD_males_lOFC$gam)
print(standardized_coefficient(modelD_males_lOFC$mer))

# Male participants (medial OFC; mOFC).
dataformodel <- data_no_mOFC_feed_outliers_males
modelD_males_mOFC <- gamm4(mOFC_posvsneg_feedback_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelD_males_mOFC$gam)
print(standardized_coefficient(modelD_males_mOFC$mer))
```

## 2.11 Model: Caudate Anticipation ~ Testosterone
### Female participants
```{r, echo = FALSE}
dataformodel <- data_no_caudate_ant_no_test_outliers_females 

confirmatory1_caudate_females <- gamm4(caudate_rvsn_ant_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(confirmatory1_caudate_females$gam)
print(standardized_coefficient(confirmatory1_caudate_females$mer))

```
### Male participants
```{r, echo = FALSE}
dataformodel <- data_no_caudate_ant_no_test_outliers_males

confirmatory1_caudate_males<- gamm4(caudate_rvsn_ant_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(confirmatory1_caudate_males$gam)
print(standardized_coefficient(confirmatory1_caudate_males$mer))

```

## 2.12 Model: Putamen Anticipation ~ Testosterone
### Female participants
```{r, echo = FALSE}
dataformodel <- data_no_putamen_ant_no_test_outliers_females 

confirmatory1_putamen_females <- gamm4(putamen_rvsn_ant_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(confirmatory1_putamen_females$gam)
print(standardized_coefficient(confirmatory1_putamen_females$mer))

```
### Male participants
```{r, echo = FALSE}
dataformodel <- data_no_putamen_ant_no_test_outliers_males 

confirmatory1_putamen_males <- gamm4(putamen_rvsn_ant_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(confirmatory1_putamen_males$gam)
print(standardized_coefficient(confirmatory1_putamen_males$mer))

```

## 2.13 Model: Accumbens Anticipation ~ Testosterone
### Female participants
```{r, echo = FALSE}
dataformodel <- data_no_accumbens_ant_no_test_outliers_females 

confirmatory1_accumbens_females <- gamm4(accumbens_rvsn_ant_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(confirmatory1_accumbens_females$gam)
print(standardized_coefficient(confirmatory1_accumbens_females$mer))

```
### Male participants
```{r, echo = FALSE}
dataformodel <- data_no_accumbens_ant_no_test_outliers_males 

confirmatory1_accumbens_males <- gamm4(accumbens_rvsn_ant_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(confirmatory1_accumbens_males$gam)
print(standardized_coefficient(confirmatory1_accumbens_males$mer))
```

## 2.14 Model: Caudate Feedback  ~ Testosterone
### Female participants
```{r, echo = FALSE}
dataformodel <- data_no_caudate_feed_no_test_outliers_females

exploratory1A_caudate_females <- gamm4(caudate_posvsneg_feedback_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1A_caudate_females$gam)
print(standardized_coefficient(exploratory1A_caudate_females$mer))
```
### Male participants
```{r, echo = FALSE}
dataformodel <- data_no_caudate_feed_no_test_outliers_males

exploratory1A_caudate_males <- gamm4(caudate_posvsneg_feedback_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1A_caudate_males$gam)
print(standardized_coefficient(exploratory1A_caudate_males$mer))

```
## 2.15 Model: Putamen Feedback ~ Testosterone
### Female participants
```{r, echo = FALSE}
dataformodel <- data_no_putamen_feed_no_test_outliers_females

exploratory1A_putamen_females <- gamm4(putamen_posvsneg_feedback_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1A_putamen_females$gam)
print(standardized_coefficient(exploratory1A_putamen_females$mer))
```
### Male participants
```{r, echo = FALSE}
dataformodel <- data_no_putamen_feed_outliers_no_test_males

exploratory1A_putamen_males <- gamm4(putamen_posvsneg_feedback_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1A_putamen_males$gam)
print(standardized_coefficient(exploratory1A_putamen_males$mer))
```
## 2.16 Model: Accumbens Feedback ~ Testosterone
### Female participants
```{r, echo = FALSE}
dataformodel <- data_no_accumbens_feed_no_test_outliers_females

exploratory1A_accumbens_females <- gamm4(accumbens_posvsneg_feedback_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1A_accumbens_females$gam)
print(standardized_coefficient(exploratory1A_accumbens_females$mer))
```
### Male participants
```{r, echo = FALSE}
dataformodel <- data_no_accumbens_feed_no_test_outliers_males

exploratory1A_accumbens_males <- gamm4(accumbens_posvsneg_feedback_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1A_accumbens_males$gam)
print(standardized_coefficient(exploratory1A_accumbens_males$mer))

```

## 2.17 Model: OFC Anticipation ~ Testosterone
### Female participants
```{r, echo = FALSE}

# Female participants (lateral OFC; lOFC).
dataformodel <- data_no_lOFC_ant_test_outliers_females
modelC_females_lOFC <- gamm4(lOFC_rvsn_ant_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelC_females_lOFC$gam)
print(standardized_coefficient(modelC_females_lOFC$mer))

# Female participants (medial OFC; mOFC).
dataformodel <- data_no_mOFC_ant_test_outliers_females
modelC_females_mOFC <- gamm4(mOFC_rvsn_ant_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelC_females_mOFC$gam)
print(standardized_coefficient(modelC_females_mOFC$mer))
```

### Male participants
```{r, echo=FALSE}
# Male participants (lateral OFC; lOFC).
dataformodel <- data_no_lOFC_ant_test_outliers_males
modelC_males_lOFC <- gamm4(lOFC_rvsn_ant_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelC_males_lOFC$gam)
print(standardized_coefficient(modelC_males_lOFC$mer))

# Male participants (medial OFC; mOFC).
dataformodel <- data_no_mOFC_ant_test_outliers_males
modelC_males_mOFC <- gamm4(mOFC_rvsn_ant_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelC_males_mOFC$gam)
print(standardized_coefficient(modelC_males_mOFC$mer))
```

## 2.18 Model: OFC Feedback ~ Testosterone
### Female participants
```{r, echo = FALSE}

# Female participants (lateral OFC; lOFC).
dataformodel <- data_no_lOFC_feed_test_outliers_females
modelD_females_lOFC <- gamm4(lOFC_posvsneg_feedback_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelD_females_lOFC$gam)
print(standardized_coefficient(modelD_females_lOFC$mer))

# Female participants (medial OFC; mOFC).
dataformodel <- data_no_mOFC_feed_test_outliers_females
modelD_females_mOFC <- gamm4(mOFC_posvsneg_feedback_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelD_females_mOFC$gam)
print(standardized_coefficient(modelD_females_mOFC$mer))
```

### Male participants
```{r, echo=FALSE}

# Male participants (lateral OFC; lOFC).
dataformodel <- data_no_lOFC_feed_test_outliers_males
modelD_males_lOFC <- gamm4(lOFC_posvsneg_feedback_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelD_males_lOFC$gam)
print(standardized_coefficient(modelD_males_lOFC$mer))


# Male participants (medial OFC; mOFC).
dataformodel <- data_no_mOFC_feed_test_outliers_males
modelD_males_mOFC <- gamm4(mOFC_posvsneg_feedback_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelD_males_mOFC$gam)
print(standardized_coefficient(modelD_males_mOFC$mer))

```

## 2.19 Model: MID Reaction Time ~ Testosterone
### Female participants
```{r, echo = FALSE}

# Female participants: large reward vs. neutral.
dataformodel <- data_no_RT_test_outliers_females # No MID RT difference score or testosterone outliers.
modelE_lg_neutral_RT_females <- gamm4(rt_diff_large_neutral_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelE_lg_neutral_RT_females$gam)
print(standardized_coefficient(modelE_lg_neutral_RT_females$mer))


# Female participants: large reward vs. small reward.
dataformodel <- data_no_RT_test_outliers_females # No MID RT difference score or testosterone outliers.
modelE_lg_small_RT_females <- gamm4(rt_diff_large_small_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelE_lg_small_RT_females$gam)
print(standardized_coefficient(modelE_lg_small_RT_females$mer))
```

### Male participants
```{r, echo=FALSE}
# Male participants: large reward vs. neutral.
dataformodel <- data_no_RT_test_outliers_males # No MID RT difference score or testosterone outliers.

modelE_lg_neutral_RT_males <- gamm4(rt_diff_large_neutral_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelE_lg_neutral_RT_males$gam)
print(standardized_coefficient(modelE_lg_neutral_RT_males$mer))

# Male participants: large reward vs. small reward.
modelE_lg_small_RT_males <- gamm4(rt_diff_large_small_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelE_lg_small_RT_males$gam)
print(standardized_coefficient(modelE_lg_small_RT_males$mer))

```

## 2.20 Model: BIS-BAS-RR ~ Testosterone
### Female participants
```{r, echo = FALSE}

dataformodel <- data_no_bisbas_test_outliers_females
modelF_females <- gamm4(bisbas_ss_basm_rr_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelF_females$gam)
print(standardized_coefficient(modelF_females$mer))

```
### Male participants
```{r, echo=FALSE}
dataformodel <- data_no_bisbas_test_outliers_males
modelF_males <- gamm4(bisbas_ss_basm_rr_z ~ hormone_scr_ert_mean + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelF_males$gam)
print(standardized_coefficient(modelF_males$mer))
```

\newpage
# 3---Internalizing~Reward---

## 3.1 Model: CBCL internalizing factor ~ Nucleus Accumbens activity (anticipation stage)
### Female participants
```{r, echo = FALSE}

dataformodel <- data_no_accumbens_ant_outliers_females

confirmatory3A_nacc_females <- gamm4(cbcl_scr_syn_internal_r ~ accumbens_rvsn_ant_z +
                              interview_age, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(confirmatory3A_nacc_females$gam)
print(standardized_coefficient(confirmatory3A_nacc_females$mer))

```
### Male participants
```{r, echo = FALSE}
dataformodel <- data_no_accumbens_ant_outliers_males

confirmatory3A_nacc_males <- gamm4(cbcl_scr_syn_internal_r ~ accumbens_rvsn_ant_z +
                              interview_age, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(confirmatory3A_nacc_males$gam)
print(standardized_coefficient(confirmatory3A_nacc_males$mer))

```

## 3.2 Model: CBCL internalizing factor ~ Caudate activity (anticipation stage)
### Female participants
```{r, echo = FALSE}
dataformodel <- data_no_caudate_ant_outliers_females

confirmatory3A_caud_females <- gamm4(cbcl_scr_syn_internal_r ~ caudate_rvsn_ant_z +
                              interview_age, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(confirmatory3A_caud_females$gam)
print(standardized_coefficient(confirmatory3A_caud_females$mer))
```
### Male participants
```{r, echo = FALSE}
dataformodel <- data_no_caudate_ant_outliers_males

confirmatory3A_caud_males <- gamm4(cbcl_scr_syn_internal_r ~ caudate_rvsn_ant_z +
                               interview_age, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(confirmatory3A_caud_males$gam)
print(standardized_coefficient(confirmatory3A_caud_males$mer))
```

## 3.3 Model: CBCL internalizing factor ~ Putamen activity (anticipation stage)
### Female participants
```{r, echo = FALSE}
dataformodel <- data_no_putamen_ant_outliers_females

confirmatory3A_putamen_females <- gamm4(cbcl_scr_syn_internal_r ~ putamen_rvsn_ant_z +
                               interview_age, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(confirmatory3A_putamen_females$gam)
print(standardized_coefficient(confirmatory3A_putamen_females$mer))


```
### Male participants
```{r, echo = FALSE}
dataformodel <- data_no_putamen_ant_outliers_males

confirmatory3A_putamen_males <- gamm4(cbcl_scr_syn_internal_r ~ putamen_rvsn_ant_z +
                              interview_age, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(confirmatory3A_putamen_males$gam)
print(standardized_coefficient(confirmatory3A_putamen_males$mer))

```


## 3.4 Model: CBCL internalizing factor ~ Accumbens activity (feedback stage)
### Female participants
```{r, echo = FALSE}
dataformodel <- data_no_accumbens_feed_outliers_females

confirmatory3B_accumbens_females <- gamm4(cbcl_scr_syn_internal_r ~ accumbens_posvsneg_feedback_z +
                              interview_age, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(confirmatory3B_accumbens_females$gam)
print(standardized_coefficient(confirmatory3B_accumbens_females$mer))

```
### Male participants
```{r, echo = FALSE}
dataformodel <- data_no_accumbens_feed_outliers_males

confirmatory3B_accumbens_males <- gamm4(cbcl_scr_syn_internal_r ~ accumbens_posvsneg_feedback_z +
                              interview_age, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(confirmatory3B_accumbens_males$gam)
print(standardized_coefficient(confirmatory3B_accumbens_males$mer))

```

## 3.5 Model: CBCL internalizing factor ~ Caudate activity (feedback stage)
### Female participants
```{r, echo = FALSE}
dataformodel <- data_no_caudate_feed_outliers_females

confirmatory3B_caudate_females <- gamm4(cbcl_scr_syn_internal_r ~ caudate_posvsneg_feedback_z +
                              interview_age, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(confirmatory3B_caudate_females$gam)
print(standardized_coefficient(confirmatory3B_caudate_females$mer))

```
### Male participants
```{r, echo = FALSE}
dataformodel <- data_no_caudate_feed_outliers_males

confirmatory3B_caudate_males <- gamm4(cbcl_scr_syn_internal_r ~ caudate_posvsneg_feedback_z +
                              interview_age, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(confirmatory3B_caudate_males$gam)
print(standardized_coefficient(confirmatory3B_caudate_males$mer))

```

## 3.6 Model: CBCL internalizing factor ~ Putamen activity (feedback stage)
### Female participants
```{r, echo = FALSE}
dataformodel <- data_no_putamen_feed_outliers_females

confirmatory3B_putamen_females <- gamm4(cbcl_scr_syn_internal_r ~ putamen_posvsneg_feedback_z +
                              interview_age, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(confirmatory3B_putamen_females$gam)
print(standardized_coefficient(confirmatory3B_putamen_females$mer))

```
### Male participants
```{r, echo = FALSE}
dataformodel <- data_no_putamen_feed_outliers_males

confirmatory3B_putamen_males <- gamm4(cbcl_scr_syn_internal_r ~ putamen_posvsneg_feedback_z +
                              interview_age, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(confirmatory3B_putamen_males$gam)
print(standardized_coefficient(confirmatory3B_putamen_males$mer))

```

## 3.7 Model: CBCL internalizing factor ~ OFC activity (anticipation stage)
### Female participants
```{r, echo = FALSE}
# Lateral OFC.
dataformodel <- data_no_lOFC_ant_outliers_females
confirmatory3C_lOFC_females <- gamm4(cbcl_scr_syn_internal_r ~ lOFC_rvsn_ant_z +
                              interview_age, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(confirmatory3C_lOFC_females$gam)
print(standardized_coefficient(confirmatory3C_lOFC_females$mer))

# Medial OFC.
dataformodel <- data_no_mOFC_ant_outliers_females
confirmatory3C_mOFC_females <- gamm4(cbcl_scr_syn_internal_r ~ mOFC_rvsn_ant_z +
                              interview_age, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(confirmatory3C_mOFC_females$gam)
print(standardized_coefficient(confirmatory3C_mOFC_females$mer))

```
### Male participants
```{r, echo = FALSE}
# Lateral OFC.
dataformodel <- data_no_lOFC_ant_outliers_males
confirmatory3C_lOFC_males <- gamm4(cbcl_scr_syn_internal_r ~ lOFC_rvsn_ant_z +
                              interview_age, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(confirmatory3C_lOFC_males$gam)
print(standardized_coefficient(confirmatory3C_lOFC_males$mer))

# Medial OFC.
dataformodel <- data_no_mOFC_ant_outliers_males
confirmatory3C_mOFC_males <- gamm4(cbcl_scr_syn_internal_r ~ mOFC_rvsn_ant_z +
                              interview_age, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(confirmatory3C_mOFC_males$gam)
print(standardized_coefficient(confirmatory3C_mOFC_males$mer))

```

## 3.8 Model: CBCL internalizing factor ~ OFC activity (feedback stage)
### Female participants
```{r, echo = FALSE}
# Lateral OFC.
dataformodel <- data_no_lOFC_feed_outliers_females

confirmatory3D_lOFC_females <- gamm4(cbcl_scr_syn_internal_r ~ lOFC_posvsneg_feedback_z +
                              interview_age, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(confirmatory3D_lOFC_females$gam)
print(standardized_coefficient(confirmatory3D_lOFC_females$mer))


# Medial OFC.
dataformodel <- data_no_mOFC_feed_outliers_females
confirmatory3D_mOFC_females <- gamm4(cbcl_scr_syn_internal_r ~ mOFC_posvsneg_feedback_z +
                              interview_age, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(confirmatory3D_mOFC_females$gam)
print(standardized_coefficient(confirmatory3D_mOFC_females$mer))

```
### Male participants
```{r, echo = FALSE}
# Lateral OFC.
dataformodel <- data_no_lOFC_feed_outliers_males

confirmatory3D_lOFC_males <- gamm4(cbcl_scr_syn_internal_r ~ lOFC_posvsneg_feedback_z +
                              interview_age, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(confirmatory3D_lOFC_males$gam)
print(standardized_coefficient(confirmatory3D_lOFC_males$mer))


# Medial OFC.
dataformodel <- data_no_mOFC_feed_outliers_males
confirmatory3D_mOFC_males <- gamm4(cbcl_scr_syn_internal_r ~ mOFC_posvsneg_feedback_z +
                              interview_age, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(confirmatory3D_mOFC_males$gam)
print(standardized_coefficient(confirmatory3D_mOFC_males$mer))

```

## 3.9 Model: CBCL internalizing factor ~ BIS-BAS-RR
### Female participants
```{r, echo = FALSE}
dataformodel <- data_no_bisbas_outliers_females

exploratory3A_females <- gamm4(cbcl_scr_syn_internal_r ~ bisbas_ss_basm_rr +
                              interview_age, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(exploratory3A_females$gam)
print(standardized_coefficient(exploratory3A_females$mer))

```
### Male participants
```{r, echo = FALSE}
dataformodel <- data_no_bisbas_outliers_males

exploratory3A_males <- gamm4(cbcl_scr_syn_internal_r ~ bisbas_ss_basm_rr +
                              interview_age, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(exploratory3A_males$gam)
print(standardized_coefficient(exploratory3A_males$mer))

```


## 3.10 Model: CBCL internalizing factor ~ MID Reaction Time
### Female participants
```{r, echo = FALSE}

# Large reward vs. neutral trial reaction time.
dataformodel <- data_no_RT_MID_outliers_females

exploratory3B_females_largereward_neutral <- gamm4(cbcl_scr_syn_internal_r ~ rt_diff_large_neutral_z +
                              interview_age, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(exploratory3B_females_largereward_neutral$gam)
print(standardized_coefficient(exploratory3B_females_largereward_neutral$mer))


# Large reward vs. small reward trial reaction time.
dataformodel <- data_no_RT_MID_outliers_females

exploratory3B_females_largesmallreward <- gamm4(cbcl_scr_syn_internal_r ~ rt_diff_large_small_z +
                              interview_age, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(exploratory3B_females_largesmallreward$gam)
print(standardized_coefficient(exploratory3B_females_largesmallreward$mer))
```
### Male participants
```{r, echo = FALSE}

# Large reward vs. neutral trial reaction time.
dataformodel <- data_no_RT_MID_outliers_males

exploratory3B_males_largereward_neutral <- gamm4(cbcl_scr_syn_internal_r ~ rt_diff_large_neutral_z +
                              interview_age, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(exploratory3B_males_largereward_neutral$gam)
print(standardized_coefficient(exploratory3B_males_largereward_neutral$mer))

# Large reward vs. small reward trial reaction time.
dataformodel <- data_no_RT_MID_outliers_males

exploratory3B_males_largesmallreward <- gamm4(cbcl_scr_syn_internal_r ~ rt_diff_large_small_z +
                              interview_age, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(exploratory3B_males_largesmallreward$gam)
print(standardized_coefficient(exploratory3B_males_largesmallreward$mer))
```

\newpage
# 4---Internalizing~Puberty x Reward---

## 4.1 Model: CBCL internalizing factor ~ PDS x Accumbens activity (anticipation stage)
### Female participants
```{r, echo = FALSE}

dataformodel <- data_no_accumbens_ant_outliers_females

confirmatory4_accumbens_ant_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            accumbens_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4_accumbens_ant_females$gam)
print(standardized_coefficient(confirmatory4_accumbens_ant_females$mer))

#plot_model(confirmatory4_accumbens_ant_females,type = "int", show.data = TRUE) #Interaction plot
```

### Male participants
```{r, echo = FALSE}

dataformodel <- data_no_accumbens_ant_outliers_males 

confirmatory4_accumbens_ant_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            accumbens_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4_accumbens_ant_males$gam)
print(standardized_coefficient(confirmatory4_accumbens_ant_males$mer))

# plot_model(confirmatory4_accumbens_ant_males,type = "int", show.data = TRUE) #Interaction plot
```

## 4.2 Model: CBCL internalizing factor ~ PDS x Caudate activity (anticipation stage)
### Female participants
```{r, echo = FALSE}

dataformodel <- data_no_caudate_ant_outliers_females

confirmatory4_caudate_ant_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            caudate_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4_caudate_ant_females$gam)
print(standardized_coefficient(confirmatory4_caudate_ant_females$mer))
#plot_model(confirmatory4_caudate_ant_females,type = "int", show.data = TRUE) #Interaction plot
```

### Male participants
```{r, echo = FALSE}

dataformodel <- data_no_caudate_ant_outliers_males

confirmatory4_caudate_ant_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            caudate_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4_caudate_ant_males$gam)
print(standardized_coefficient(confirmatory4_caudate_ant_males$mer))

#plot_model(confirmatory4_caudate_ant_females,type = "int", show.data = TRUE) #Interaction plot
```


## 4.3 Model: CBCL internalizing factor ~ PDS x Putamen activity (anticipation stage)
### Female participants
```{r, echo = FALSE}

dataformodel <- data_no_putamen_ant_outliers_females

confirmatory4_putamen_ant_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            putamen_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4_putamen_ant_females$gam)
print(standardized_coefficient(confirmatory4_putamen_ant_females$mer))

#plot_model(confirmatory4_caudate_ant_females,type = "int", show.data = TRUE) #Interaction plot
```

### Male participants
```{r, echo = FALSE}

dataformodel <- data_no_putamen_ant_outliers_males

confirmatory4_putamen_ant_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            putamen_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4_putamen_ant_males$gam)
print(standardized_coefficient(confirmatory4_putamen_ant_males$mer))
#plot_model(confirmatory4_caudate_ant_females,type = "int", show.data = TRUE) #Interaction plot
```
## 4.4 Model: CBCL internalizing factor ~ PDS x Lateral OFC activity (anticipation stage)
### Female participants
```{r, echo = FALSE}
#Lateral OFC anticipation, FEMALES

dataformodel <- data_no_lOFC_ant_outliers_females

exploratory4b_OFC_ant_allCBCL_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            lOFC_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4b_OFC_ant_allCBCL_females$gam)
print(standardized_coefficient(exploratory4b_OFC_ant_allCBCL_females$mer))

```

### Male participants
```{r, echo = FALSE}
#Lateral OFC anticipation, MALES

dataformodel <- data_no_lOFC_ant_outliers_males

exploratory4b_OFC_ant_allCBCL_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            lOFC_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4b_OFC_ant_allCBCL_males$gam)
print(standardized_coefficient(exploratory4b_OFC_ant_allCBCL_males$mer))
```

## 4.5 Model: CBCL internalizing factor ~ PDS x Medial OFC activity (anticipation stage)
### Female participants
```{r, echo=FALSE}
#Medial OFC anticipation, FEMALES

dataformodel <- data_no_mOFC_ant_outliers_females

exploratory4b_mOFC_ant_allCBCL_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            mOFC_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                           interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4b_mOFC_ant_allCBCL_females$gam)
print(standardized_coefficient(exploratory4b_mOFC_ant_allCBCL_females$mer))

```

### Male participants
```{r, echo=FALSE}
#Medial OFC anticipation, MALES

dataformodel <- data_no_mOFC_ant_outliers_males

exploratory4b_mOFC_ant_allCBCL_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            mOFC_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4b_mOFC_ant_allCBCL_males$gam)
print(standardized_coefficient(exploratory4b_mOFC_ant_allCBCL_males$mer))

```

## 4.6 Model: CBCL internalizing factor ~ PDS x Accumbens activity (feedback)
### Female participants
```{r, echo = FALSE}
#Accumbens feedback, females
dataformodel <- data_no_accumbens_feed_outliers_females

exploratory4a_accumbens_feedback_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            accumbens_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())
summary(exploratory4a_accumbens_feedback_females$gam)
print(standardized_coefficient(exploratory4a_accumbens_feedback_females$mer))

```
### Male participants
```{r, echo = FALSE}
#Accumbens feedback, males

dataformodel <- data_no_accumbens_feed_outliers_males

exploratory4a_accumbens_feedback_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            accumbens_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())
summary(exploratory4a_accumbens_feedback_males$gam)
print(standardized_coefficient(exploratory4a_accumbens_feedback_males$mer))

```

## 4.7 Model: CBCL internalizing factor ~ PDS x Caudate activity (feedback)
### Female participants
```{r, echo = FALSE}

dataformodel <- data_no_caudate_feed_outliers_females

exploratory4a_caudate_feedback_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            caudate_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())
summary(exploratory4a_caudate_feedback_females$gam)
print(standardized_coefficient(exploratory4a_caudate_feedback_females$mer))

```

### Male participants
```{r, echo = FALSE}

dataformodel <- data_no_caudate_feed_outliers_males

exploratory4a_caudate_feedback_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            caudate_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())
summary(exploratory4a_caudate_feedback_males$gam)
print(standardized_coefficient(exploratory4a_caudate_feedback_males$mer))

```

## 4.8 Model: CBCL internalizing factor ~ PDS x Putamen activity (feedback)
### Female participants
```{r, echo = FALSE}

dataformodel <- data_no_putamen_feed_outliers_females

exploratory4a_putamen_feedback_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            putamen_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())
summary(exploratory4a_putamen_feedback_females$gam)
print(standardized_coefficient(exploratory4a_putamen_feedback_females$mer))

```

### Male participants
```{r, echo = FALSE}
#Putamen feedback", males

dataformodel <- data_no_putamen_feed_outliers_males

exploratory4a_putamen_feedback_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            putamen_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())
summary(exploratory4a_putamen_feedback_males$gam)
print(standardized_coefficient(exploratory4a_putamen_feedback_males$mer))

```

## 4.9 Model: CBCL internalizing factor ~ PDS x Lateral OFC activity (feedback stage)
### Female participants
```{r, echo = FALSE}
#Lateral OFC feedback, FEMALES

dataformodel <- data_no_lOFC_feed_outliers_females

exploratory4b_OFC_feed_allCBCL_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            lOFC_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                           interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4b_OFC_feed_allCBCL_females$gam)
print(standardized_coefficient(exploratory4b_OFC_feed_allCBCL_females$mer))

```

### Male participants
```{r, echo = FALSE}
#Lateral OFC feedback, MALES

dataformodel <- data_no_lOFC_feed_outliers_males

exploratory4b_OFC_feed_allCBCL_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            lOFC_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4b_OFC_feed_allCBCL_males$gam)
print(standardized_coefficient(exploratory4b_OFC_feed_allCBCL_males$mer))

```

## 4.10 Model: CBCL internalizing factor ~ PDS x Medial OFC activity (feedback stage)
### Female participants
```{r, echo=FALSE}
#Medial OFC Feedback, FEMALES
dataformodel <- data_no_mOFC_feed_outliers_females

exploratory4b_mOFC_feed_allCBCL_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            mOFC_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4b_mOFC_feed_allCBCL_females$gam)
print(standardized_coefficient(exploratory4b_mOFC_feed_allCBCL_females$mer))

```


### Male participants
```{r, echo=FALSE}
#Medial OFC feedback, MALES

dataformodel <- data_no_mOFC_feed_outliers_males

exploratory4b_mOFC_feed_allCBCL_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            mOFC_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4b_mOFC_feed_allCBCL_males$gam)
print(standardized_coefficient(exploratory4b_mOFC_feed_allCBCL_males$mer))

```


## 4.11 Model: CBCL internalizing factor ~ PDS x BIS-BAS
### Female participants
```{r, echo = FALSE}

dataformodel <- data_no_bisbas_outliers_females

exploratory4c_bisbas_allCBCL_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            bisbas_ss_basm_rr+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())
summary(exploratory4c_bisbas_allCBCL_females$gam)
print(standardized_coefficient(exploratory4c_bisbas_allCBCL_females$mer))

```

### Male participants
```{r, echo = FALSE}
dataformodel <- data_no_bisbas_outliers_males

exploratory4c_bisbas_allCBCL_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            bisbas_ss_basm_rr+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())
summary(exploratory4c_bisbas_allCBCL_males$gam)
print(standardized_coefficient(exploratory4c_bisbas_allCBCL_males$mer))

```

## 4.12 Model: CBCL internalizing factor ~ PDS x MID reaction time (large reward vs. neutral)
### Female participants
```{r, echo = FALSE}

dataformodel <- data_no_RT_MID_outliers_females

#Large reward vs. neutral positive.
exploratory4c_lg_neutral_RT_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            rt_diff_large_neutral_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4c_lg_neutral_RT_females$gam)
print(standardized_coefficient(exploratory4c_lg_neutral_RT_females$mer))

```

### Male participants
```{r, echo=FALSE}
dataformodel <- data_no_RT_MID_outliers_males

#Large reward vs. neutral positive.
exploratory4c_lg_neutral_RT_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            rt_diff_large_neutral_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4c_lg_neutral_RT_males$gam)
print(standardized_coefficient(exploratory4c_lg_neutral_RT_males$mer))

```

## 4.13 Model: CBCL internalizing factor ~ PDS x MID reaction time (large vs. small reward)
### Female participants
```{r, echo = FALSE}
dataformodel <- data_no_RT_MID_outliers_females

#Large reward vs. small reward positive.
exploratory4c_lg_small_RT_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            rt_diff_large_small_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4c_lg_small_RT_females$gam)
print(standardized_coefficient(exploratory4c_lg_small_RT_females$mer))

```

### Male participants
```{r, echo=FALSE}
dataformodel <- data_no_RT_MID_outliers_males

#Large reward vs. small reward positive.
exploratory4c_lg_small_RT_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            rt_diff_large_small_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                           interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4c_lg_small_RT_males$gam)
print(standardized_coefficient(exploratory4c_lg_small_RT_males$mer))

```

## 4.14 Model: CBCL internalizing factor ~ Testosterone x Accumbens activity (anticipation stage) + PDS
### Female participants
```{r, echo = FALSE}

dataformodel <- data_no_accumbens_ant_no_test_outliers_females

confirmatory4Ea_accumbens_test_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            accumbens_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4Ea_accumbens_test_females$gam)
print(standardized_coefficient(confirmatory4Ea_accumbens_test_females$mer))

#plot_model(confirmatory4_accumbens_ant_females,type = "int", show.data = TRUE) #Interaction plot
```
### Male participants
```{r, echo = FALSE}

dataformodel <- data_no_accumbens_ant_no_test_outliers_males

confirmatory4Ea_accumbens_test_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            accumbens_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4Ea_accumbens_test_males$gam)
print(standardized_coefficient(confirmatory4Ea_accumbens_test_males$mer))

#plot_model(confirmatory4_accumbens_ant_females,type = "int", show.data = TRUE) #Interaction plot
```

## 4.15 Model: CBCL internalizing factor ~ Testosterone x Caudate activity (anticipation stage) + PDS
### Female participants
```{r, echo = FALSE}

dataformodel <- data_no_caudate_ant_no_test_outliers_females

confirmatory4Ea_caudate_test_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            caudate_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4Ea_caudate_test_females$gam)
print(standardized_coefficient(confirmatory4Ea_caudate_test_females$mer))

#plot_model(confirmatory4_accumbens_ant_females,type = "int", show.data = TRUE) #Interaction plot
```

### Male participants
```{r, echo = FALSE}

dataformodel <- data_no_caudate_ant_no_test_outliers_males

confirmatory4Ea_caudate_test_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            caudate_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4Ea_caudate_test_males$gam)
print(standardized_coefficient(confirmatory4Ea_caudate_test_males$mer))

```

## 4.16 Model: CBCL internalizing factor ~ Testosterone x Putamen activity (anticipation stage) + PDS
### Female participants
```{r, echo = FALSE}

dataformodel <- data_no_putamen_ant_no_test_outliers_females

confirmatory4Ea_putamen_test_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            putamen_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4Ea_putamen_test_females$gam)
print(standardized_coefficient(confirmatory4Ea_putamen_test_females$mer))
```

### Male participants
```{r, echo = FALSE}

dataformodel <- data_no_putamen_ant_no_test_outliers_males

confirmatory4Ea_putamen_test_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            putamen_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4Ea_putamen_test_males$gam)
print(standardized_coefficient(confirmatory4Ea_putamen_test_males$mer))

```

## 4.17 Model: CBCL internalizing factor ~ Testosterone x Accumbens activity (feedback stage) + PDS
### Female participants
```{r, echo = FALSE}

dataformodel <- data_no_accumbens_feed_no_test_outliers_females

exploratory4Eb_accumbens_test_feed_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            accumbens_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4Eb_accumbens_test_feed_females$gam)
print(standardized_coefficient(exploratory4Eb_accumbens_test_feed_females$mer))

```
### Male participants
```{r, echo = FALSE}

dataformodel <- data_no_accumbens_feed_no_test_outliers_males

exploratory4Eb_accumbens_test_feed_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            accumbens_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4Eb_accumbens_test_feed_males$gam)
print(standardized_coefficient(exploratory4Eb_accumbens_test_feed_males$mer))

```

## 4.18 Model: CBCL internalizing factor ~ Testosterone x Caudate activity (Feedback stage) + PDS
### Female participants
```{r, echo = FALSE}
dataformodel <- data_no_caudate_feed_no_test_outliers_females

confirmatory4Eb_caudate_test_feed_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            caudate_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4Eb_caudate_test_feed_females$gam)
print(standardized_coefficient(confirmatory4Eb_caudate_test_feed_females$mer))

```

### Male participants
```{r, echo = FALSE}

dataformodel <- data_no_caudate_feed_no_test_outliers_males

confirmatory4Eb_caudate_test_feed_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            caudate_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4Eb_caudate_test_feed_males$gam)
print(standardized_coefficient(confirmatory4Eb_caudate_test_feed_males$mer))

```

## 4.19 Model: CBCL internalizing factor ~ Testosterone x Putamen activity (Feedback stage) + PDS
### Female participants
```{r, echo = FALSE}
dataformodel <- data_no_putamen_feed_no_test_outliers_females

confirmatory4Eb_putamen_test_feed_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            putamen_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4Eb_putamen_test_feed_females$gam)
print(standardized_coefficient(confirmatory4Eb_putamen_test_feed_females$mer))

```

### Male participants
```{r, echo = FALSE}

dataformodel <- data_no_putamen_feed_outliers_no_test_males

confirmatory4Eb_putamen_test_feed_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            putamen_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4Eb_putamen_test_feed_males$gam)
print(standardized_coefficient(confirmatory4Eb_putamen_test_feed_males$mer))

```

## 4.20 Model: CBCL internalizing factor ~ Testosterone x Lateral OFC activity (anticipation stage) + PDS
### Female participants
```{r, echo=FALSE}
#Lateral OFC

dataformodel <- data_no_lOFC_ant_test_outliers_females 

exploratory4c_OFC_ant_allCBCL_test_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            lOFC_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4c_OFC_ant_allCBCL_test_females$gam)
print(standardized_coefficient(exploratory4c_OFC_ant_allCBCL_test_females$mer))

```

### Male participants
```{r, echo=FALSE}
#Lateral OFC
dataformodel <- data_no_lOFC_ant_test_outliers_males 

exploratory4c_OFC_ant_allCBCL_test_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                           PDS_score+
                            hormone_scr_ert_mean*  
                            lOFC_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4c_OFC_ant_allCBCL_test_males$gam)
print(standardized_coefficient(exploratory4c_OFC_ant_allCBCL_test_males$mer))

```

## 4.21 Model: CBCL internalizing factor ~ Testosterone x Medial OFC activity (anticipation stage) + PDS
### Female participants
```{r, echo=FALSE}
#Medial OFC
dataformodel <- data_no_mOFC_ant_test_outliers_females 

exploratory4c_mOFC_ant_allCBCL_test_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            mOFC_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4c_mOFC_ant_allCBCL_test_females$gam)
print(standardized_coefficient(exploratory4c_mOFC_ant_allCBCL_test_females$mer))

```

### Male participants
```{r, echo=FALSE}
#Medial OFC
dataformodel <- data_no_mOFC_ant_test_outliers_males 

exploratory4c_mOFC_ant_allCBCL_test_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                           PDS_score+
                            hormone_scr_ert_mean*  
                            mOFC_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4c_mOFC_ant_allCBCL_test_males$gam)
print(standardized_coefficient(exploratory4c_mOFC_ant_allCBCL_test_males$mer))

```

## 4.22 Model: CBCL internalizing factor ~ Testosterone x Lateral OFC activity (feedback stage) + PDS
### Female participants
```{r, echo = FALSE}
#Lateral OFC feedback

dataformodel <- data_no_lOFC_feed_test_outliers_females 

exploratory4d_OFC_feed_allCBCL_test_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean* 
                            lOFC_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4d_OFC_feed_allCBCL_test_females$gam)
print(standardized_coefficient(exploratory4d_OFC_feed_allCBCL_test_females$mer))

```

### Male participants
```{r, echo = FALSE}
#Lateral OFC feedback

dataformodel <- data_no_lOFC_feed_test_outliers_males 

exploratory4d_OFC_feed_allCBCL_test_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean* 
                            lOFC_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4d_OFC_feed_allCBCL_test_males$gam)
print(standardized_coefficient(exploratory4d_OFC_feed_allCBCL_test_males$mer))

```

## 4.23 Model: CBCL internalizing factor ~ Testosterone x Medial OFC activity (feedback stage) + PDS
### Female participants
```{r, echo=FALSE}
#Medial OFC feedback

dataformodel <- data_no_mOFC_feed_test_outliers_females 

exploratory4d_mOFC_feed_allCBCL_test_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean* 
                            mOFC_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4d_mOFC_feed_allCBCL_test_females$gam)
print(standardized_coefficient(exploratory4d_mOFC_feed_allCBCL_test_females$mer))

```

### Male participants
```{r, echo=FALSE}
#Medial OFC feedback

dataformodel <- data_no_mOFC_feed_test_outliers_males 

exploratory4d_mOFC_feed_allCBCL_test_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean* 
                            mOFC_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4d_mOFC_feed_allCBCL_test_males$gam)
print(standardized_coefficient(exploratory4d_mOFC_feed_allCBCL_test_males$mer))

```


## 4.24 Model: CBCL internalizing factor ~ Testosterone x BIS-BAS RR + PDS
### Female participants
```{r, echo = FALSE}

dataformodel <- data_no_bisbas_test_outliers_females 

exploratory4e_bisbas_allCBCL_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*
                            bisbas_ss_basm_rr+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())
summary(exploratory4e_bisbas_allCBCL_females$gam)
print(standardized_coefficient(exploratory4e_bisbas_allCBCL_females$mer))

```

### Male participants
```{r, echo = FALSE}

dataformodel <- data_no_bisbas_test_outliers_males 

exploratory4e_bisbas_allCBCL_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*
                            bisbas_ss_basm_rr+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                           interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())
summary(exploratory4e_bisbas_allCBCL_males$gam)
print(standardized_coefficient(exploratory4e_bisbas_allCBCL_males$mer))

```

## 4.25 Model: CBCL internalizing factor ~ Testosterone x MID Reaction Time + PDS (large reward vs. neutral) 
### Female participants 
```{r, echo = FALSE}

dataformodel <- data_no_RT_test_outliers_females

#Large reward vs. neutral.
exploratoryFa_lg_neutral_RT_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*
                            rt_diff_large_neutral_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratoryFa_lg_neutral_RT_females$gam)
print(standardized_coefficient(exploratoryFa_lg_neutral_RT_females$mer))

```
### Male participants 
```{r, echo = FALSE}
dataformodel <- data_no_RT_test_outliers_males

#Large reward vs. neutral.
exploratoryFa_lg_neutral_RT_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*
                            rt_diff_large_neutral_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratoryFa_lg_neutral_RT_males$gam)
print(standardized_coefficient(exploratoryFa_lg_neutral_RT_males$mer))

```

## 4.26 Model: CBCL internalizing factor ~ Testosterone x MID Reaction Time + PDS (large vs. small reward)
### Female participants 
```{r, echo = FALSE}
#Large reward vs. small reward positive.
dataformodel <- data_no_RT_test_outliers_females

exploratoryFb_lg_small_RT_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*
                            rt_diff_large_small_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratoryFb_lg_small_RT_females$gam)
print(standardized_coefficient(exploratoryFb_lg_small_RT_females$mer))

```

### Male participants
```{r, echo = FALSE}
#Large reward vs. small reward positive.

dataformodel <- data_no_RT_test_outliers_males

exploratoryFb_lg_small_RT_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*
                            rt_diff_large_small_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratoryFb_lg_small_RT_males$gam)
print(standardized_coefficient(exploratoryFb_lg_small_RT_males$mer))

```
\newpage
# 5--- Correlation Matrix ---
## Female participants
```{r,echo = FALSE,cols.print=5}
# Remove outliers from the variables that we removed outliers for in the analyses.
# From the manuscript: Outliers were defined as values 3 standard deviations away from the mean (based on z-scores calculated after exclusion criteria were taken into account). Outliers were removed for BAS-RR, neuroimaging data, MID reaction time data (Pizzagalli et al., 2009), and testosterone scores (Herting et al., 2021). No outliers were excluded based on z-scores for CBCL because (1) variable-specific inclusion criteria were already taken into account when calculating scores for these variables and (2) even the more extreme values were deemed as within plausible range for these variables.

# Only keep variables that are going into the matrix.
# Note: We are including BMI here as well, even though that is technically from the sensitivity analysis (Supplements C and D).

# Note: Use z scored version instead for most of these.
# Use dataframe that has z scored reaction time difference scores and merge that with PDS_correct.

cor_female <- MID_task_correct_females %>% dplyr::select("src_subject_id","rt_diff_large_neutral_z","rt_diff_large_small_z") 
cor_female <- merge(PDS_correct_females,cor_female, by = "src_subject_id",all.x=TRUE)

variables_with_outliers <- c("hormone_scr_ert_mean_z",
                "bisbas_ss_basm_rr_z",
                "rt_diff_large_neutral_z",
                "rt_diff_large_small_z",
                "accumbens_rvsn_ant_z", # Accumbens reward vs. neutral anticipation.
                "caudate_rvsn_ant_z", # Caudate reward vs. neutral anticipation.
                "putamen_rvsn_ant_z", # Putamen reward vs. neutral anticipation.
                "mOFC_rvsn_ant_z", # Medial OFC reward vs. neutral anticipation.
                "lOFC_rvsn_ant_z", # Lateral OFC reward vs. neutral anticipation.
                "accumbens_posvsneg_feedback_z", # Accumbens reward positive versus negative feedback.
                "caudate_posvsneg_feedback_z", # Caudate reward positive versus negative feedback.
                "putamen_posvsneg_feedback_z", # Putamen reward positive versus negative feedback.
                "mOFC_posvsneg_feedback_z",  # Medial OFC reward positive versus negative feedback.
                "lOFC_posvsneg_feedback_z") # Lateral OFC reward positive versus negative feedback.

cor_female <- cor_female  %>% 
  dplyr::select("interview_age",
                "bmi",
                "PDS_score",
                "cbcl_scr_syn_internal_r",
                all_of(variables_with_outliers))

#dim(cor_female) # 2701 rows,  18 columns.
# All of the z score ones need to be cleaned so that if it is < -3 or >3, it is replaced with NA instead.

# This is a two step process: First,  across all columns, replace all z scores greater than 3 or less than -3 with -99.
# Then, replace all -99 with "NA".
cor_female[ ,variables_with_outliers][ cor_female[ ,variables_with_outliers] > 3] <- -99
cor_female[ ,variables_with_outliers][ cor_female[ ,variables_with_outliers] < -3] <- -99
cor_female <- cor_female %>% replace_with_na_all(condition = ~.x == -99)
#sum(is.na(cor_female$caudate_posvsneg_feedback_z)) # 464.

# Now make correlation matrix!
# Function from: http://www.sthda.com/english/wiki/correlation-matrix-a-quick-start-guide-to-analyze-format-and-visualize-a-correlation-matrix-using-r-software#compute-correlation-matrix-in-r
# ++++++++++++++++++++++++++++
# flattenCorrMatrix
# ++++++++++++++++++++++++++++
# cormat : matrix of the correlation coefficients
# pmat : matrix of the correlation p-values
flattenCorrMatrix <- function(cormat, pmat,nmat) {
  ut <- upper.tri(cormat)
  data.frame(
    x1 = rownames(cormat)[col(cormat)[ut]],
    x2= rownames(cormat)[row(cormat)[ut]],
    N = nmat[ut],
    corr  =(cormat)[ut],
    p = pmat[ut]
    )
}

cormat_females <- rcorr(as.matrix(cor_female))
cormat_females_flat <- flattenCorrMatrix(cormat_females$r, cormat_females$P,cormat_females$n)
knitr::kable(format(cormat_females_flat, scientific = F))

```
## Male participants
```{r,echo = FALSE,cols.print=5}

cor_male <- MID_task_correct_males %>% dplyr::select("src_subject_id","rt_diff_large_neutral_z","rt_diff_large_small_z") 
cor_male <- merge(PDS_correct_males,cor_male, by = "src_subject_id",all.x=TRUE)

cor_male <- cor_male   %>% 
  dplyr::select("interview_age",
                "bmi",
                "PDS_score",
                "cbcl_scr_syn_internal_r",
                all_of(variables_with_outliers))

#dim(cor_male) # 2986 rows,  18 columns.
# All of the z score ones need to be cleaned so that if it is < -3 or >3, it is replaced with NA instead.
# This is a two step process: First,  across all columns, replace all z scores greater than 3 or less than -3 with -99.
# Then, replace all -99 with "NA".
cor_male[ ,variables_with_outliers][ cor_male[ ,variables_with_outliers] > 3] <- -99
cor_male[ ,variables_with_outliers][ cor_male[ ,variables_with_outliers] < -3] <- -99
cor_male <- cor_male %>% replace_with_na_all(condition = ~.x == -99)

# Now make correlation matrix!
cormat_males <- rcorr(as.matrix(cor_male))
cormat_males_flat <- flattenCorrMatrix(cormat_males$r, cormat_males$P,cormat_males$n)
knitr::kable(format(cormat_males_flat, scientific = F))

```

\newpage
# 6--- Compare Outliers to Non-Outliers on Demographic Variables ---
## Female participants
```{r,echo = FALSE,cols.print=5, warning=FALSE}

# Demographic variables to compare.
demographic_variables <- c("sex",
                           "bmi",
                           "interview_age",
                           "race.ethnicity.5level",
                           "household.income",
                           "high.educ",
                           "demo_race_hispanic")

MID_task_correct_females <- MID_task_correct_females %>% dplyr::select("src_subject_id","rt_diff_large_neutral_z","rt_diff_large_small_z") 


females <- merge(PDS_correct_females, MID_task_correct_females, by = "src_subject_id",all.x=TRUE, all.y = TRUE)
females <- females %>% select("src_subject_id",all_of(demographic_variables),all_of(variables_with_outliers))


females  <- females %>%
  mutate(is_outlier_any = case_when(
                  (hormone_scr_ert_mean_z < -3 |  hormone_scr_ert_mean_z > 3 |
                   bisbas_ss_basm_rr_z < -3 |  bisbas_ss_basm_rr_z > 3 |
                   rt_diff_large_neutral_z < -3 |  rt_diff_large_neutral_z > 3 |
                   rt_diff_large_small_z < -3 |  rt_diff_large_small_z > 3 |
                   accumbens_rvsn_ant_z< -3 |  accumbens_rvsn_ant_z > 3 |
                   caudate_rvsn_ant_z < -3 |  caudate_rvsn_ant_z > 3 |
                   putamen_rvsn_ant_z < -3 |  putamen_rvsn_ant_z > 3 |
                   mOFC_rvsn_ant_z < -3 |  mOFC_rvsn_ant_z > 3 |
                   lOFC_rvsn_ant_z < -3 |  lOFC_rvsn_ant_z > 3 |
                   accumbens_posvsneg_feedback_z < -3 |  accumbens_posvsneg_feedback_z > 3 |
                   caudate_posvsneg_feedback_z < -3 |  caudate_posvsneg_feedback_z > 3 |
                   putamen_posvsneg_feedback_z < -3 |  putamen_posvsneg_feedback_z > 3 |
                   mOFC_posvsneg_feedback_z < -3 |  mOFC_posvsneg_feedback_z > 3 |
                   lOFC_posvsneg_feedback_z < -3 | lOFC_posvsneg_feedback_z> 3) ~ "outlier",
    TRUE ~ "not outlier"))

females$is_outlier_any <- as.factor(females$is_outlier_any)

demographic_differences_females <- compareGroups(is_outlier_any ~
                                           interview_age +
                                           bmi +
                                           race.ethnicity.5level +
                                           household.income+
                                           high.educ +
                                           demo_race_hispanic, 
                     data = females)

pvals <- getResults(demographic_differences_females, "p.overall")
p.adjust(pvals, method = "BH")
export_table_females <- createTable(demographic_differences_females)
print(export_table_females)
```
## Male participants
```{r,echo = FALSE,cols.print=5, warning=FALSE}

MID_task_correct_males <- MID_task_correct_males %>% dplyr::select("src_subject_id","rt_diff_large_neutral_z","rt_diff_large_small_z") 

males <- merge(PDS_correct_males, MID_task_correct_males, by = "src_subject_id",all.x=TRUE, all.y = TRUE)
males <- males %>% select("src_subject_id",all_of(demographic_variables),all_of(variables_with_outliers))

males  <- males %>%
  mutate(is_outlier_any = case_when(
                  (hormone_scr_ert_mean_z < -3 |  hormone_scr_ert_mean_z > 3 |
                   bisbas_ss_basm_rr_z < -3 |  bisbas_ss_basm_rr_z > 3 |
                   rt_diff_large_neutral_z < -3 |  rt_diff_large_neutral_z > 3 |
                   rt_diff_large_small_z < -3 |  rt_diff_large_small_z > 3 |
                   accumbens_rvsn_ant_z< -3 |  accumbens_rvsn_ant_z > 3 |
                   caudate_rvsn_ant_z < -3 |  caudate_rvsn_ant_z > 3 |
                   putamen_rvsn_ant_z < -3 |  putamen_rvsn_ant_z > 3 |
                   mOFC_rvsn_ant_z < -3 |  mOFC_rvsn_ant_z > 3 |
                   lOFC_rvsn_ant_z < -3 |  lOFC_rvsn_ant_z > 3 |
                   accumbens_posvsneg_feedback_z < -3 |  accumbens_posvsneg_feedback_z > 3 |
                   caudate_posvsneg_feedback_z < -3 |  caudate_posvsneg_feedback_z > 3 |
                   putamen_posvsneg_feedback_z < -3 |  putamen_posvsneg_feedback_z > 3 |
                   mOFC_posvsneg_feedback_z < -3 |  mOFC_posvsneg_feedback_z > 3 |
                   lOFC_posvsneg_feedback_z < -3 | lOFC_posvsneg_feedback_z> 3) ~ "outlier",
    TRUE ~ "not outlier"))

males$is_outlier_any <- as.factor(males$is_outlier_any)

demographic_differences_males <- compareGroups(is_outlier_any ~
                                           interview_age +
                                           bmi +
                                           race.ethnicity.5level +
                                           household.income+
                                           high.educ +
                                           demo_race_hispanic, 
                     data = males)

pvals <- getResults(demographic_differences_males, "p.overall")
p.adjust(pvals, method = "BH")
export_table_males <- createTable(demographic_differences_males)
print(export_table_males)
```
